{"version":3,"sources":["components/Button/Button.jsx","components/ButtonGroup/ButtonGroup.jsx","util/color.js","util/treeUtil.js","util/collisions.js","tools/ResizeTool.js","tools/CutTools.js","sounds/snip.wav","shapes/Cut/Cut.js","util/proof-util.js","components/SideBar/SideBar.jsx","components/MenuBar/MenuIcons/logo.png","components/MenuBar/MenuItem.js","components/MenuBar/MenuItems.js","components/MenuBar/MenuBar.jsx","components/App/App.jsx","sounds/pop.wav","shapes/Premise/Premise.js","tools/PremiseTools.js","util/otherUtil.js","sounds/delete.wav","index.js"],"names":["Button","className","onClick","this","props","text","React","Component","ButtonGroup","buttons","map","button","color","background","odd","inactive","active","even","default","findRoot","node","get","getParentCell","default_background_colors","premise","colorByLevel","color_config","console","log","root","attributes","type","attr","level","children","getEmbeddedCells","length","parity","next_children","child","attrs","push","handleCollisions","cell","cellbbox","width","rect","height","x","position","y","parent","cells","smallest_area","smallest_cell","area","findSmallestCell","targetbbox","graph","getCells","potential_parents","contains","findPotentialParents","new_child_bbox","potential_children","id","findElementsInside","filterChildren","embed","unembed","treeToFront","elements_inside","element","bbox","elements","otherbbox","bbox_info","otherbbox_info","current","next","toFront","createResizeTool","config","r","fill","offset","cursor","markup","tagName","selector","substring","rotate","prev_pos","current_pos","MIN_SIZE","resize_mousedown","event","target","getCell","$","clientX","clientY","document","on","resize_mouseup","direction","getAttribute","resize_mousemove","stopPropagation","size","data","delta","modifiers","size_x","size_y","pos_x","pos_y","RangeError","irection","set","Object","assign","off","CUT_DEFAULTS","class","stroke","strokeWidth","fontSize","ref","Cut","options","_","cloneDeep","cut","addTo","elementView","findView","paper","removeTools","boundaryTool","joint","Boundary","NWresizeTool","NEresizeTool","SWresizeTool","SEresizeTool","el","rect_tools","toolsView","ToolsView","tools","addTools","hideTools","addCutTools","hasparent","toBack","resize_value","center_nodes","treeResize","Audio","Snip","play","remove","Element","inferenceInsertion","model","inferenceErasure","embeds","destroy","forEach","__proto__","constructor","name","insertDoubleCut","mousePosition","Error","multipliers","i","create","deleteDoubleCut","iteration","deiteration","SideBar","state","proof","window","action","style","backgroundColor","mode","charAt","toUpperCase","slice","onStateSwitch","MenuItem","styling","SVGS","xmlns","viewBox","d","transform","img","marginLeft","margin_left","MenuItems","open","input","createElement","onchange","ev","file","files","reader","FileReader","readAsText","onload","readerEvent","content","result","confirm","clear","dataObj","JSON","parse","fromJSON","alert","click","graphJSON","toJSON","Blob","stringify","a","url","URL","createObjectURL","href","download","body","appendChild","setTimeout","removeChild","revokeObjectURL","MenuBar","menu_item","App","setState","handleStateSwitch","PREMISE_DEFAULTS","Premise","addPremiseTools","Pop","addSubgraph","subgraph","keys","root_clone","clone","new_root","subgraphToGraph","treeMove","findCellInSubgraph","NSPremise","define","NSCut","ReactDOM","render","getElementById","selected_premise","undefined","saved_template","Graph","cellNamespace","nameSpace","PAPER_SIZE","Paper","preventContextMenu","clickThreshold","cellViewNamespace","paperContainer","mouse_down","temp_cut","initial_cut_pos","which","setInteractivity","addEventListener","evt","mouse_adjusted","getBoundingClientRect","left","top","Math","min","abs","preventDefault","key","keyCode","delete_noise","Delete","error","shiftKey","toLocaleLowerCase","toLocaleUpperCase","new_cut","cloneSubgraph","deep","cellView","showTools","modelView"],"mappings":"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","file":"static/js/main.932bbad3.chunk.js","sourcesContent":["import React from 'react';\n\nimport './Button.css';\n\nexport default class Button extends React.Component {\n    render() {\n        return (\n            <button className='button-group-button' onClick={this.props.onClick}>{this.props.text}</button>\n        );\n    }\n}","import React from 'react';\n\nimport Button from '../Button/Button';\n\nimport './ButtonGroup.css';\n\nexport default class ButtonGroup extends React.Component {\n    render() {\n        return (\n            <div className=\"button-group\">\n                {this.props.buttons.map(button => <Button key={button.text} text={button.text} onClick={button.onClick}/>)}\n            </div>\n        );\n    }\n}","export let color = {\n    shapes: {\n        background: {\n            odd: {\n                inactive: \"#f2f8fc\",\n                active: \"#f2f8fcE0\"\n            },\n            even: {\n                inactive: \"#ffffff\",\n                active: \"#ffffffE0\"\n            },\n            default: {\n                color: \"#ffffff00\"\n            }\n        }\n    }\n}","import { color } from \"./color.js\"\nimport { graph } from \"../index.js\"\n\nexport function treeResize(root, resize_value = 20, center_nodes = true) {\n    console.log(\"resize_value\",resize_value)\n    //resizes all the children of a root, not including the root\n    let current = root.getParentCell();\n    while (current) {\n        console.log(\"current\", current)\n        current.attr(\"rect/width\", current.attributes.attrs.rect.width + resize_value);\n        current.attr(\"rect/height\", current.attributes.attrs.rect.height + resize_value);\n        if (center_nodes) {\n            current.set(\"position\", {x: current.attributes.position.x - resize_value/2,\n                                     y: current.attributes.position.y - resize_value/2});\n        }\n        current = current.getParentCell();\n    }\n}\n\nexport function findRoot(node) {\n    while (true) {\n        if (node.get(\"parent\")) {\n            node = node.getParentCell();\n        } else {\n            break;\n        }\n    }\n    return node;\n}\n\nexport function findLevel(node) {\n    let level = 0;\n    let parent = node.getParentCell();\n    while (parent) {\n        level++;\n        parent = parent.getParentCell();\n    }\n    console.log(\"level:\", level)\n    return level;\n}\n\nlet default_background_colors = {\n    even: color.shapes.background.even.inactive,\n    odd: color.shapes.background.odd.inactive,\n    premise: color.shapes.background.default.color\n}\n\nexport function colorByLevel(node, color_config = default_background_colors) {\n    console.log(\"RECOLOR START =====\");\n\n    //find root of node's tree\n    let root = findRoot(node);\n\n    if (root.attributes.type === \"dia.Element.Premise\") {\n        console.log(\"premise root\");\n        root.attr('rect/fill', color_config.premise);\n        return;\n    }\n    //otherwise its a cut root\n\n    root.attr(\"level\", 0);\n    root.attr(\"rect/fill\", color_config.odd)\n    let level = 0;\n    let children = root.getEmbeddedCells();\n    while(children.length > 0) {\n        level++\n        //the color applies to the level contained within the cut, not the level the cut is on\n        let parity = (level+1) % 2;\n        console.log(\"level: parity\", level, parity)\n        let next_children = []\n        for (const child of children) {\n            console.log(\"child\", child)\n            child.attr(\"level\", level);\n            if (child.attributes.type === \"dia.Element.Premise\") {\n                console.log(\"is premise\")\n                child.attr(\"rect/fill\", color_config.premise)\n                continue;\n            }\n            //coloring cut\n            child.attributes.attrs.level = level;\n            if (parity === 0) {\n                console.log(\"even!!\")\n                child.attr(\"rect/fill\", color_config.even) \n            } else {\n                console.log(\"odd!!\");\n                child.attr(\"rect/fill\", color_config.odd);   \n            }                                 \n            next_children.push(...child.getEmbeddedCells());\n        }\n        children = next_children;\n    }\n\n}\n\nexport function treeMove(root, position) {\n    let offset = {\n        x: position.x - root.attributes.position.x,\n        y: position.y - root.attributes.position.y\n    }\n    console.log(offset);\n    let current = [];\n    let next = [root];\n    while (next.length > 0) {\n        current = next;\n        next = [];\n        console.log(current);\n        for (const node of current) {\n            next.push(...node.getEmbeddedCells());\n            node.position(node.attributes.position.x + offset.x, node.attributes.position.y + offset.y);\n        }\n    }\n\n}","import { graph } from '../index.js'\nimport { colorByLevel } from './treeUtil.js';\n\n//      CELL         -- the cell in question that we are checking\n//                      collisions for (premise OR cut).\n// POTENTIAL PARENTS -- potential parents are only the cells that \n//                      contain (completely) the CELL.\n//   ACTUAL PARENT   -- the smallest cell (if there are any) that\n//                      is a member of potential parents.\n//   CHILDREN        -- If ACTUAL PARENT exists, POTENTIAL CHILDREN\n//                          are cells that are contained (completely)\n//                          by the CELL, AND are also currently\n//                          children of ACTUAL PARENT.   \n//                      Otherwise: CHILDREN are any cells that are\n//                          contained (completely) inside the CELL\n//                          that have NO parents.\nexport function handleCollisions(cell) {\n    //This function takes a Cell as input and, using its position\n    // makes any necessary changes to the internal representation of\n    // the diagram (parent / child structure (embedding)) to reflect what the user\n    // sees on the paper\n    let cellbbox = {\n        width: cell.attributes.attrs.rect.width,\n        height: cell.attributes.attrs.rect.height,\n        x: cell.attributes.position.x,\n        y: cell.attributes.position.y\n    }\n\n    let potential_parents = findPotentialParents(cellbbox);\n    let parent = findSmallestCell(potential_parents);\n\n    if (parent) {\n        let children = filterChildren(parent, cellbbox)\n        //embed cell into parent\n        parent.embed(cell);\n\n        //reroot children\n        for (const child of children) {\n            if (child.get(\"parent\")) {\n                parent.unembed(child);\n                cell.embed(child)\n            }\n        }\n        treeToFront(parent)\n    } else {\n        let elements_inside = findElementsInside(cellbbox)\n        for (const element of elements_inside) {\n            if (element.get(\"parent\") || element.id === cell.id) {\n                continue;\n            }\n            cell.embed(element)\n        }\n        treeToFront(cell)\n    }\n    //recolor trees to reflect new level structure\n    colorByLevel(cell);\n\n    //check \n}\n\nfunction findElementsInside(bbox, cells=graph.getCells()) {\n    //takes two bbox objects as input\n    //bbox objects should have the structure:\n    // {\n    //      width: int,\n    //      height: int,\n    //      x: int,\n    //      y: int\n    // }\n    let elements = []\n    for (const cell of cells) {\n        let otherbbox = {\n            width: cell.attributes.attrs.rect.width,\n            height: cell.attributes.attrs.rect.height,\n            x: cell.attributes.position.x,\n            y: cell.attributes.position.y\n        }\n        if (contains(bbox, otherbbox)) {\n            elements.push(cell)\n        }\n    }\n    return elements\n}\n\nfunction findPotentialParents(targetbbox) {\n    // POTENTIAL PARENTS -- potential parents are only the cells that \n    //                      contain (completely) the CELL.\n    let cells = graph.getCells()\n    let potential_parents = []\n    for (const cell of cells) {\n        let otherbbox = {\n            width: cell.attributes.attrs.rect.width,\n            height: cell.attributes.attrs.rect.height,\n            x: cell.attributes.position.x,\n            y: cell.attributes.position.y\n        }\n        //find cells who contain target cell\n        if (contains(otherbbox, targetbbox)) {\n            //console.log(\"potential parent found\")\n            potential_parents.push(cell)\n        }\n    }\n\n    return potential_parents\n}\n\nfunction findSmallestCell(cells) {\n    // returns the smallest cell (by area) of an array of joint.dia.Cell objects\n    if (cells.length === 0) { return undefined }\n    let smallest_area = cells[0].attributes.attrs.rect.width * cells[0].attributes.attrs.rect.height;\n    let smallest_cell = cells[0];\n    for (const cell of cells) {\n        let width = cell.attributes.attrs.rect.width;\n        let height = cell.attributes.attrs.rect.height;\n        let area = width * height;\n        if (area < smallest_area) {\n            smallest_area = area;\n            smallest_cell = cell;\n        }\n    }\n    return smallest_cell\n}\n\nfunction filterChildren(parent, new_child_bbox) {\n    //function returns array of children who fit inside new child\n    let cells = graph.getCells();\n    let potential_children = [];\n    for (const cell of cells) {\n        if (!(cell.get(\"parent\")) || cell.get(\"parent\") === parent.id){\n            potential_children.push(cell)\n        }\n    }\n    let children = findElementsInside(new_child_bbox, potential_children)\n    return children;\n}\n\nfunction contains(bbox, otherbbox) {\n    // returns true of otherbbox fits completely inside of bbox\n    let bbox_info = {\n        left_x: bbox.x,\n        right_x: bbox.x + bbox.width,\n        top_y: bbox.y,\n        bottom_y: bbox.y + bbox.height\n    }\n    let otherbbox_info = {\n        left_x: otherbbox.x,\n        right_x: otherbbox.x + otherbbox.width,\n        top_y: otherbbox.y,\n        bottom_y: otherbbox.y + otherbbox.height\n    }\n    if (bbox_info.left_x < otherbbox_info.left_x && bbox_info.right_x > otherbbox_info.right_x && bbox_info.top_y < otherbbox_info.top_y && bbox_info.bottom_y > otherbbox_info.bottom_y) {\n        //console.log(\"bbox contains otherbbox\", bbox, otherbbox);\n        return true;\n    } else {\n        return false;\n    }\n}\n\nexport function treeToFront(root) {\n    //loops through a tree from its root to the leaves\n    //to ensure correct z order\n    let current = [root]\n    let next = []\n    while (current.length > 0) {\n        for (const node of current) {\n            node.toFront();\n            let children = node.getEmbeddedCells();\n            next.push(...children);\n        }\n        current = next\n        next = []\n    }\n}","import $ from 'jquery';\n\nexport function createResizeTool(config) {\n    let r = (config && config.r) || 7;\n    let fill = (config && config.fill) || \"transparent\";\n    let x = (config && config.x) || \"0%\";\n    let y = (config && config.y) || \"0%\";\n    let offset = (config && config.offset) || {x: 0, y:0};\n    let cursor = (config && config.cursor) || \"nw-resize\";\n\n    let ResizeTool = {\n        markup: [{\n            tagName: 'circle',\n            selector: 'button',\n            attributes: {\n                'r': r,\n                'fill': fill,\n                'cursor': cursor,\n                'data-direction': cursor.substring(0,2)\n            }\n        }],\n        x: x,\n        y: y,\n        offset: offset,\n        rotate: true,\n    };\n    return ResizeTool\n}\n\n","import * as joint from \"jointjs\"\nimport $ from 'jquery';\nimport { graph, paper } from \"../index.js\"\nimport { handleCollisions } from \"../util/collisions.js\";\nimport { createResizeTool } from \"./ResizeTool.js\" \n\n\nexport function addCutTools(element) {\n    //element view is in charge of rendering the elements on the paper\n    let elementView = element.findView(paper);\n    //clear any old tools\n    elementView.removeTools();\n    // boundary tool shows boundaries of element\n    let boundaryTool = new joint.elementTools.Boundary();\n\n    let NWresizeTool = new joint.elementTools.Button(createResizeTool({\n        x: \"0%\",\n        y:\"0%\",\n        cursor: \"nw-resize\"\n    }));\n    let NEresizeTool = new joint.elementTools.Button(createResizeTool({\n        x: \"100%\",\n        y:\"0%\",\n        cursor: \"ne-resize\"\n    }));\n    let SWresizeTool = new joint.elementTools.Button(createResizeTool({\n        x: \"0%\",\n        y:\"100%\",\n        cursor: \"sw-resize\"\n    }));\n    let SEresizeTool = new joint.elementTools.Button(createResizeTool({\n        x: \"100%\",\n        y:\"100%\",\n        cursor: \"se-resize\"\n    }));\n\n    //add event handlers to tools for resizing\n    $(NWresizeTool.el).on('mousedown', resize_mousedown);\n    $(NEresizeTool.el).on('mousedown', resize_mousedown);\n    $(SWresizeTool.el).on('mousedown', resize_mousedown);\n    $(SEresizeTool.el).on('mousedown', resize_mousedown);\n\n    let rect_tools = [boundaryTool, NWresizeTool, NEresizeTool, SEresizeTool, SWresizeTool];\n\n    let toolsView = new joint.dia.ToolsView({\n        tools: rect_tools\n    });\n\n    elementView.addTools(toolsView);\n    //start with tools hidden\n    elementView.hideTools();\n    // element.on(\"change:position\", function (eventView) {\n    //     element.toFront();\n    // });\n    // --- end of paper events -----\n}\n\n\n//global objects for cut resizing\nlet prev_pos = {\n    x: 0,\n    y: 0\n}\n\nlet current_pos = {\n    x: 0,\n    y: 0\n}\n\n//TODO: THIS NEEDS TO CHANGE BASED ON HOW MANY THINGS ARE IN THE\n//CUT AND WHERE THEY ARE\nconst MIN_SIZE = {\n    width: 40,\n    height: 40\n}\n\n/**\n * Event handler that sets up resizing when the user first puts their mouse down\n * on a resize tool.\n * @param {MouseEvent} event\n */\nfunction resize_mousedown(event) {\n    const target = graph.getCell($(event.target).parent().attr('model-id'));\n    console.log('target model', target);\n    prev_pos = {\n        x: event.clientX,\n        y: event.clientY\n    }\n    \n    $(document).on('mouseup', { target }, resize_mouseup);\n    $(document).on('mousemove', { target, direction: event.target.getAttribute('data-direction') },  resize_mousemove);\n    event.stopPropagation();\n\n    if (target.get('parent')) {\n        graph.getCell(target.get('parent')).unembed(target);\n    }\n}\n\n/**\n * Performs different resizing algorithms based on the direction of resizing\n * @param {MouseEvent} event `event.data` has the following data:\n *          * target: Cut object representing what Cut the tool belongs to\n */\nfunction resize_mousemove(event) {\n    //update current pos to mouse position\n    current_pos = {\n        x: event.clientX,\n        y: event.clientY\n    }\n\n    //extract copy of size from target Cut \n    const size = {\n        width: event.data.target.attributes.attrs.rect.width,\n        height: event.data.target.attributes.attrs.rect.height\n    };\n\n    //extract copy of position from target Cut\n    const position = {\n        x: event.data.target.attributes.position.x,\n        y: event.data.target.attributes.position.y\n    }\n\n    //calclulate change in mouse position\n    const delta = {\n        x: current_pos.x - prev_pos.x,\n        y: current_pos.y - prev_pos.y\n    }\n\n    //define modifiers to determine how\n    //size/position should respond to the deltas\n    const modifiers = {\n        size_x: 1,\n        size_y: 1,\n        pos_x: 0,\n        pos_y: 0\n    }\n\n    //set the modifiers based on the direction we are resizing\n    switch (event.data.direction) {\n        case 'nw':\n            modifiers.size_x = -1;\n            modifiers.size_y = -1;\n            modifiers.pos_x = 1;\n            modifiers.pos_y = 1;\n            break;\n        case 'ne':\n            modifiers.size_x = 1;\n            modifiers.size_y = -1;\n            modifiers.pos_x = 0;\n            modifiers.pos_y = 1;\n            break;\n        case 'sw':\n            modifiers.size_x = -1;\n            modifiers.size_y = 1;\n            modifiers.pos_x = 1;\n            modifiers.pos_y = 0;\n            break;\n        case 'se':\n            modifiers.size_x = 1;\n            modifiers.size_y = 1;\n            modifiers.pos_x = 0;\n            modifiers.pos_y = 0;\n            break;\n        default:\n            throw new RangeError('Invalid direction value. Expected nw, ne, sw, se. Got ' + event.data.irection);\n    }\n    \n    //if the resize will put us at under MIN_SIZE, then set respective delta to 0 to cancel resize\n    if (size.width + modifiers.size_x * delta.x < MIN_SIZE.width) delta.x = 0;\n    if (size.height + modifiers.size_y * delta.y < MIN_SIZE.height) delta.y = 0;\n\n    //set size based on modifiers and deltas\n    event.data.target.attr('rect/width',  size.width + modifiers.size_x * delta.x);\n    event.data.target.attr('rect/height', size.height + modifiers.size_y * delta.y);\n\n    //adjust position to offset size changes in certain directions\n    event.data.target.set('position',  { x: position.x + modifiers.pos_x * delta.x, y: position.y + modifiers.pos_y * delta.y});\n    \n    //copy current_pos to prev_pos\n    prev_pos = Object.assign({}, current_pos);\n}\n\n/**\n * Cleans up resize event\n * @param {MouseEvent} event `event.data` has the following data:\n *          * target: Cut object representing what Cut the tool belongs to\n */\nfunction resize_mouseup (event) {\n    $(document).off('mouseup', resize_mouseup);\n    $(document).off('mousemove', resize_mousemove);\n    handleCollisions(event.data.target);\n}","export default __webpack_public_path__ + \"static/media/snip.6f2bc4d7.wav\";","// class for cuts\nimport * as joint from 'jointjs'\nimport { graph } from '../../index.js'\nimport { addCutTools } from '../../tools/CutTools.js'\nimport { handleCollisions, treeToFront } from '../../util/collisions.js'\nimport _ from 'lodash';\nimport Snip from '../../sounds/snip.wav'\nimport { treeResize, findRoot, findLevel, colorByLevel } from '../../util/treeUtil.js';\nimport { color } from '../../util/color.js';\n\n\nconst CUT_DEFAULTS = {\n    position: {\n        x: 10,\n        y: 10\n    },\n    size: {\n        width: 40, \n        height: 40\n    },\n    attrs: {\n        rect: {\n            class: 'cut_rect',\n            width: 40,\n            height: 40,\n            fill: '#ffffff99',\n            stroke: 'black',\n            strokeWidth: 2,\n        },\n        text: {\n            class: 'cut_text',\n            fontSize: 30,\n            'ref-x': 0.5,\n            'ref-y': 0.5,\n            ref: 'rect',\n            'y-alignment': 'middle',\n            'x-alignment': 'middle',\n        }\n    }\n}\n\nexport class Cut extends joint.dia.Element {\n    defaults() {\n        return {\n            ...super.defaults,\n            type: \"dia.Element.Cut\",\n            attrs: {\n                rect: CUT_DEFAULTS.attrs.rect,\n                text: CUT_DEFAULTS.attrs.text\n            }\n        }\n    }\n\n    markup = [{\n        tagName: \"rect\",\n        selector: \"body\"\n    },{\n        tagName: \"text\",\n        selector: \"label\"\n    }]\n\n    //custom constructor for shape, should more or less always use this over the default constructor\n    create(config) {\n\n        const options = _.cloneDeep(CUT_DEFAULTS);\n        if (config) {\n            options.position = Object.assign(options.position, config.position);\n            options.size = Object.assign(options.size, config.size);\n            options.attrs.rect = Object.assign(options.attrs.rect, config.attrs && config.attrs.rect);\n            options.attrs.text = Object.assign(options.attrs.text, config.attrs && config.attrs.text);\n        }\n\n        console.log('options', _.cloneDeep(options));\n\n        \n        let cut = new Cut({\n            markup: '<rect/><text/>',\n            position: {\n                ...options.position\n            },\n            size: {\n                ...options.size\n            },\n            attrs: {\n                rect: {\n                    ...options.attrs.rect\n                },\n                text: {\n                    ...options.attrs.text\n                },\n                level: 0\n            },\n            // set custom attributes here:\n        })\n        cut.addTo(graph);\n        //add tools (some events events also)\n        addCutTools(cut);\n\n        //check for children\n        if (config && config.child) {\n            let child = config.child;\n            let hasparent = false;\n            if (child.get(\"parent\")) {\n                let parent = graph.getCell(child.get(\"parent\"));\n                parent.unembed(child);\n                parent.embed(cut)\n                parent.toBack()\n                hasparent = true;\n            }\n            cut.embed(child)\n            cut.attr(\"rect/width\", child.attributes.attrs.rect.width + cut.attributes.attrs.rect.width)\n            cut.attr(\"rect/height\", child.attributes.attrs.rect.height + cut.attributes.attrs.rect.height)\n            cut.set(\"position\", {\n                x: child.attributes.position.x - (cut.attributes.attrs.rect.width - child.attributes.attrs.rect.width) / 2,\n                y: child.attributes.position.y - (cut.attributes.attrs.rect.height - child.attributes.attrs.rect.height) / 2,\n            })\n            if (hasparent) {\n                treeResize(cut, cut.attributes.attrs.rect.width / 2);\n            }\n        }\n        console.log(cut);\n        handleCollisions(cut);\n\n        // Play snip sound\n        let snip = new Audio(Snip); \n        snip.play();\n        return cut;\n    }\n\n    destroy() {\n        //check if cut has parents or children, if so children become new children of parent;\n        let parent = this.getParentCell();\n        let children = this.getEmbeddedCells()\n        for (const child of children) {\n            this.unembed(child)\n        }\n        this.remove();\n        if (parent) {\n            handleCollisions(parent);\n        }\n    }\n\n    active() {\n        //cut is being interacted with (ie grabbing, dragging or moving etc)\n        colorByLevel(this, {even:color.shapes.background.even.active, odd:color.shapes.background.odd.active, premise: color.shapes.background.default.color});\n    }\n\n    inactive() {\n        //cut is not being interacted with (ie grabbing, dragging or moving etc)\n        colorByLevel(this, {even:color.shapes.background.even.inactive, odd:color.shapes.background.odd.inactive, premise: color.shapes.background.default.color});\n    }\n}\n\nObject.assign(joint, {\n    \"dia.Element\": {\n        Cut\n    }\n})","import { Cut } from \"../shapes/Cut/Cut\"\nimport { graph } from \"../index.js\"\nimport  { handleCollisions} from './collisions.js'\n\n\n\n\nexport const inferenceInsertion = function(model) {\n    // if(window.mode != 'create') return;\n    // console.log(event.which);\n    // //a-z for creating premise\n    // if (event.keyCode >= 65 && event.keyCode <= 90) {\n    //     let config = {\n    //         //use capital letters by default, can press shift to make lowercase\n    //         attrs:{\n    //             text: {\n    //                 text:event.shiftKey ? key.toLocaleLowerCase() : key.toLocaleUpperCase()\n    //             }\n    //         },\n    //         position: {\n    //             x: mousePosition.x - paperContainer.getBoundingClientRect().left - 20,\n    //             y: mousePosition.y - paperContainer.getBoundingClientRect().top - 20\n    //         }\n    //     }\n    //     //eslint-disable-next-line\n    //     let new_rect = new Premise().create(config)\n    // }\n}\n\nexport const inferenceErasure = function(model) {\n  console.log(model.attributes.attrs.level)\n  if(model.attributes.attrs.level%2 === 0) {\n    const children = model.attributes.attrs.embeds;\n    model.destroy();\n    if(model.attributes.parent) {\n      handleCollisions(graph.getCell(model.attributes.parent));\n    }\n    else {\n      children?.forEach(element => {\n          if(graph.getCell(element).__proto__.constructor.name == \"Cut\") {\n            handleCollisions(graph.getCell(element))\n          }\n      });\n    }  \n  }\n}\n\nexport const insertDoubleCut = function(model, mousePosition={}) {\n    let position = {};\n    let size = {}\n    if (!model && mousePosition) {\n        position = mousePosition;\n        size = { width: 40, height: 40 }\n    }\n    else if (model){\n        position = model.get('position');\n        size = { width: model.attr('rect/width'), height: model.attr('rect/height') }\n    }\n    else {\n        throw new Error('Bad arguments');\n    }\n    const multipliers = [0.5, 0.25];\n    for(let i = 0; i < multipliers.length; i++) { \n        const cut = new Cut().create({\n            position: position,\n            attrs: {\n                rect: {\n                    width: size.width * (1 + multipliers[i]),\n                    height: size.height * (1 + multipliers[i])\n                }\n            }\n        });\n        cut.set('position', {\n            x: cut.get('position').x - (size.width * multipliers[i]/2),\n            y: cut.get('position').y - (size.height * multipliers[i]/2)\n        });\n        handleCollisions(cut);\n    }  \n}\n\nexport const deleteDoubleCut = function(model) {\n    console.log(\"MODEL: \", model);\n    if(model.__proto__.constructor.name == \"Cut\" && model.attributes.embeds?.length == 1 && \n        graph.getCell(model.attributes.embeds[0]).__proto__.constructor.name == \"Cut\") {\n          const children = graph.getCell(model.attributes.embeds[0]).attributes.embeds;\n          graph.getCell(model.attributes.embeds[0]).destroy();\n          model.destroy();\n          if(model.attributes.parent) {\n            handleCollisions(graph.getCell(model.attributes.parent));\n          }\n          else {\n            children?.forEach(element => {\n                if(graph.getCell(element).__proto__.constructor.name == \"Cut\") {\n                  handleCollisions(graph.getCell(element))\n                }\n            });\n          }\n    }\n}\n\nexport const iteration = function(model) {\n}\n\nexport const deiteration = function(model) {\n}","import React from 'react';\n\nimport ButtonGroup from '../ButtonGroup/ButtonGroup';\nimport Button from '../Button/Button';\n\nimport './SideBar.css';\nimport { deiterating, deiteration, deleteDoubleCut, inferenceErasure, inferenceInsertion, insertDoubleCut, iteration } from '../../util/proof-util';\n\nexport default class SideBar extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            buttons: {\n                create: [\n                    {\n                        text: 'Add Premise',\n                        onClick: function() {\n                            console.log('Adding premise...')\n                        }\n                    },\n                    {\n                        text: 'Cut',\n                        onClick: function() {\n                            console.log('Cutting...');\n                        }\n                    }\n                ],\n                proof: [\n                    {\n                        text: 'Insertion',\n                        onClick: function() {\n                            window.action = inferenceInsertion;\n                            console.log('Performing insertion...');\n                        }\n                    },\n                    {\n                        text: 'Erasure',\n                        onClick: function() {\n                            window.action = inferenceErasure;\n                            console.log('Performing erasure...');\n                        }\n                    },\n                    {\n                        text: 'Insert Double Cut',\n                        onClick: function() {\n                            window.action = insertDoubleCut;\n                            console.log('Inserting double cut...');\n                        }\n                    },\n                    {\n                        text: 'Delete Double Cut',\n                        onClick: function() {\n                            window.action = deleteDoubleCut;\n                            console.log('Deleting double cut...');\n                        }\n                    },\n                    {\n                        text: 'Iteration',\n                        onClick: function() {\n                            window.action = iteration;\n                            console.log('Performing iteration...');\n                        }\n                    },\n                    {\n                        text: 'Deiteration',\n                        onClick: function() {\n                            window.action = deiteration;\n                            console.log('Performing deiteration...');\n                        }\n                    }\n                ]\n            },\n            color : {\n                text : {\n                    create : \"#E0FBFC\",\n                    proof : \"#293241\"\n                },\n                background : {\n                    create : \"#3D5A80\",\n                    proof : \"#98C1D9\"\n                }\n            }\n        }\n    }\n    render() {\n        return (\n            <div className=\"menu-bar\" style={{backgroundColor: this.state.color.background[this.props.mode] , color: this.state.color.text[this.props.mode]}}>\n                <div id=\"side-wrapper\" >\n                    <h2 >{this.props.mode.charAt(0).toUpperCase() + this.props.mode.slice(1)} Mode</h2>\n                    <Button text=\"Switch Mode\" onClick={this.props.onStateSwitch}></Button>\n                    <ButtonGroup buttons={this.state.buttons[this.props.mode]} mode={this.props.mode}/>\n                </div>\n            </div>\n        ); \n    }\n}\n\n","export default __webpack_public_path__ + \"static/media/logo.1839c7ce.png\";","import React from 'react';\nimport importIcon from './MenuIcons/import.png';\nimport exportIcon from './MenuIcons/export.png';\nimport logoIcon from './MenuIcons/logo.png';\n\nimport './MenuBar.css'\n\nexport default function MenuItem(props) {\n\n\n  const styling = `\n    .cls-1{\n      fill:#ed6b4d;\n      stroke:#e2f3f7;\n      stroke-miterlimit:10;\n      stroke-width:12px;\n    }\n    .cls-2 {\n      fill:#e2f3f7;\n    }\n  `;\n\n  const SVGS = {\n    './MenuIcons/logo.png': <svg id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.23 762.74\" width=\"8vh\" height=\"8vh\"><defs><style>{styling}</style></defs><path class=\"cls-1\" d=\"M1022,769v96.74q0,19.28-3.79,30.81a49,49,0,0,1-13.94,20.83q-10.17,9.28-26,17.9Q932.46,960,890.12,971.41t-92.27,11.36q-58.17,0-106-17.91t-81.58-52q-33.75-34.08-51.81-82.62Q543.75,790.83,541,743.9c-1,0-1.92,0-2.9,0H256.29q-33.87,0-48.71-15t-14.84-48.54V295.58q0-22.33,6.63-36.49a41.18,41.18,0,0,1,20.78-20.6Q234.3,232,256.29,232H530.06q24.78,0,36.84,11t12,28.81q0,18.15-12,29.15t-36.84,11H296.45V437.7h215.1q23.74,0,35.44,10.65t11.7,28.11q0,17.48-11.52,28.46t-35.62,11H296.45V661.53H538.09q3.76,0,7.26.27a287.88,287.88,0,0,1,12.56-47.73q17.55-48.89,51.64-83t83-52.15q48.88-18.07,110.85-18.08,51,0,90.2,13.6t63.69,34.25q24.43,20.67,36.83,43.73t12.39,41q0,19.29-14.28,32.88a47.94,47.94,0,0,1-34.26,13.6,46.05,46.05,0,0,1-21.17-5.17,48,48,0,0,1-17-14.46q-18.93-29.6-32-44.75T852.42,550q-22.2-10.34-56.63-10.33-35.46,0-63.34,12.22a130.87,130.87,0,0,0-47.68,35.46q-19.8,23.24-30.3,57T644,719.07q0,88.81,40.8,136.67t113.77,47.85a231.88,231.88,0,0,0,66.62-9.3,337.73,337.73,0,0,0,63.17-26.51V785.85H849.15q-28.57,0-43.21-8.61T791.31,748q0-16.86,12.22-27.88t33.22-11h116q21.35,0,36.15,3.79a40.81,40.81,0,0,1,23.92,16.87Q1022,742.82,1022,769Z\" transform=\"translate(-186.74 -226.03)\"/></svg>\n    ,'./MenuIcons/export.png': <svg id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.24 898.25\" width=\"4vh\" height=\"4vh\"><defs><style>{styling}</style></defs><path class=\"cls-2\" d=\"M1020.62,789.78v249a40.18,40.18,0,0,1-40.18,40.17H219.56a40.18,40.18,0,0,1-40.18-40.17v-249a40.18,40.18,0,0,1,40.18-40.18h58.25A40.18,40.18,0,0,1,318,789.78V940.34H882V789.78a40.18,40.18,0,0,1,40.17-40.18h58.25A40.18,40.18,0,0,1,1020.62,789.78Z\" transform=\"translate(-179.38 -180.69)\"/><path class=\"cls-2\" d=\"M384.19,390.1,533.64,240.66l48.21-48.21a38.5,38.5,0,0,1,55.4,0l48.22,48.22L834.9,390.1a40.17,40.17,0,0,1,0,56.81L793.71,488.1a40.17,40.17,0,0,1-56.81,0L679,430.18V751.79A40.18,40.18,0,0,1,638.81,792H580.55a40.18,40.18,0,0,1-40.17-40.17V429.91L482.19,488.1a40.17,40.17,0,0,1-56.81,0l-41.19-41.19A40.17,40.17,0,0,1,384.19,390.1Z\" transform=\"translate(-179.38 -180.69)\"/><path class=\"cls-2\" d=\"M665.69,620.82a40.39,40.39,0,0,1-5.61,7L618.9,669a40.08,40.08,0,0,1-29.11,11.76A40,40,0,0,0,617.48,669Z\" transform=\"translate(-179.38 -180.69)\"/><path class=\"cls-2\" d=\"M589.79,680.79A40,40,0,0,1,560.67,669l-41.19-41.19a40.14,40.14,0,0,1-5.62-7L562.08,669A40,40,0,0,0,589.79,680.79Z\" transform=\"translate(-179.38 -180.69)\"/></svg>\n    ,'./MenuIcons/import.png': <svg id=\"Layer_1\" data-name=\"Layer 1\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 841.24 898.26\" width=\"4vh\" height=\"4vh\"><defs><style>{styling}</style></defs><path class=\"cls-2\" d=\"M1020.62,789.78v249a40.18,40.18,0,0,1-40.18,40.17H219.56a40.18,40.18,0,0,1-40.18-40.17v-249a40.18,40.18,0,0,1,40.18-40.18h58.25A40.18,40.18,0,0,1,318,789.78V940.34H882V789.78a40.18,40.18,0,0,1,40.17-40.18h58.25A40.18,40.18,0,0,1,1020.62,789.78Z\" transform=\"translate(-179.38 -180.68)\"/><path class=\"cls-2\" d=\"M834.91,582.54,685.46,732l-48.21,48.21a38.5,38.5,0,0,1-55.4,0L533.63,732,384.2,582.54a40.17,40.17,0,0,1,0-56.81l41.19-41.19a40.17,40.17,0,0,1,56.81,0l57.92,57.92V220.85a40.18,40.18,0,0,1,40.17-40.17h58.26a40.18,40.18,0,0,1,40.17,40.17V542.73l58.19-58.19a40.17,40.17,0,0,1,56.81,0l41.19,41.19A40.17,40.17,0,0,1,834.91,582.54Z\" transform=\"translate(-179.38 -180.68)\"/><path class=\"cls-2\" d=\"M665.69,620.82a40.39,40.39,0,0,1-5.61,7L618.9,669a40.08,40.08,0,0,1-29.11,11.76A40,40,0,0,0,617.48,669Z\" transform=\"translate(-179.38 -180.68)\"/><path class=\"cls-2\" d=\"M589.79,680.79A40,40,0,0,1,560.67,669l-41.19-41.19a40.14,40.14,0,0,1-5.62-7L562.08,669A40,40,0,0,0,589.79,680.79Z\" transform=\"translate(-179.38 -180.68)\"/></svg>\n  }\n  let size = props.text==='' ? '100%' : '70%';\n  let text = props.img==='' ? \"100%\" : \"70%\";\n  let img_vis = props.img==='' ? \"hidden\" : \"visable\";\n\n  return (\n\n    <div style={{marginLeft: props.margin_left, cursor:'pointer'}} className=\"menu-item\" onClick={props.onClick}>\n      {SVGS[props.img]}\n      {/* <img style={{visibility:img_vis}} src={props.img} alt={props.text} width={size+\"\"} height={size+\"\"}/> */}\n      <h4 style={{fontSize: text}}>{props.text}</h4>\n    </div>\n  )\n}\n\n","import importIcon from './MenuIcons/import.png';\nimport exportIcon from './MenuIcons/export.png';\nimport logoIcon from './MenuIcons/logo.png';\n\nimport { graph } from '../../index.js';\n\nconst MenuItems = [\n  {\n    text: '',\n    img: './MenuIcons/logo.png',\n    onClick: function(){\n      window.open('https://github.com/eddiekrystowski/existential-graphs')\n    },\n    margin_left: '0vw',\n  },\n  {\n    text: 'Existential Graphs',\n    img: '',\n    onClick: function(){\n      return;\n    },\n    margin_left: '1vw',\n  },\n  {\n    text: 'Import',\n    img: './MenuIcons/import.png',\n    onClick: importEG,\n    margin_left: '10vw',\n  },\n  {\n    text: 'Export',\n    img: './MenuIcons/export.png',\n    onClick: exportEG,\n    margin_left: '5vw',\n  },\n]\n\n\n  //Funtions for the above MenuItems\nfunction exportEG() {\n  console.log('Exporting...');\n  let graphJSON = graph.toJSON();\n  const file = new Blob([JSON.stringify(graphJSON)], { type: 'application/json'});\n    const a = document.createElement(\"a\");\n    let url = URL.createObjectURL(file);\n    a.href = url;\n    a.download = 'graph.json';\n    document.body.appendChild(a);\n    a.click();\n    setTimeout(function () {\n        document.body.removeChild(a);\n        window.URL.revokeObjectURL(url);\n    }, 0);\n}\n\nfunction importEG() {\n  console.log('Importing...');\n  const input = document.createElement(\"input\");\n    input.type = \"file\";\n    // choosing the file\n    input.onchange = function (ev) {\n        const file = ev.target.files[0];\n        if (file.type !== \"application/json\") {\n            alert(\"File must be of .JSON type\");\n            return;\n        }\n        // read the file\n        const reader = new FileReader();\n        reader.readAsText(file, 'UTF-8');\n        reader.onload = function (readerEvent) {\n            const content = readerEvent.target.result;\n            const erase = window.confirm(\"Erase your current workspace and import graph?\");\n            if (erase) {\n                graph.clear();\n                const dataObj = JSON.parse(content);\n                graph.fromJSON(dataObj);\n                \n            }\n        };\n    };\n    input.click();\n}\n\nexport default MenuItems;","import React from 'react';\nimport MenuItem from './MenuItem.js';\nimport MenuItems from './MenuItems.js';\nimport './MenuBar.css';\n\nexport default function MenuBar() {\n  return (\n    <div className=\"header-bar\">\n      {MenuItems.map(menu_item => <MenuItem text={menu_item.text} img={menu_item.img} onClick={menu_item.onClick} margin_left={menu_item.margin_left} key={menu_item.text}/>)}\n    </div>\n  )\n}","import React from 'react';\n\nimport '../../index.css'; \nimport SideBar from '../SideBar/SideBar.jsx';\nimport MenuBar from '../MenuBar/MenuBar.jsx';\n\nexport default class App extends React.Component {\n    constructor(props) {\n        super(props);\n        this.state = {\n            mode: 'create'\n        }\n    }\n\n    handleStateSwitch() {\n        console.log('Switching state...');\n        console.log(this.state);\n        this.setState({\n            mode: this.state.mode === 'create' ? 'proof' : 'create'\n        });\n        window.mode = this.state.mode === 'create' ? 'proof' : 'create';\n    }\n\n    render() {\n        return (\n            <div className=\"app\">\n                <MenuBar id=\"header\"/>\n                <SideBar mode={this.state.mode} onStateSwitch={() => { this.handleStateSwitch(); }}></SideBar>\n                \n                <div id=\"paper-wrapper\">\n                    <div id=\"paper-container\"></div>\n                </div>\n            </div>\n        );\n    }\n}","export default __webpack_public_path__ + \"static/media/pop.cddf7df9.wav\";","import * as joint from 'jointjs'\nimport _ from 'lodash'\nimport { graph } from '../../index.js'\nimport { addPremiseTools } from '../../tools/PremiseTools.js'\nimport './Premise.css'\nimport { handleCollisions } from '../../util/collisions.js'\nimport Pop from '../../sounds/pop.wav'\nimport { color } from '../../util/color.js'\n// class for premises (letters)\n\nconst PREMISE_DEFAULTS = {\n  position: {\n    x: 10,\n    y: 10\n  },\n  size: {\n    width: 40,\n    height: 40\n  },\n  attrs: {\n    rect: {\n      class: 'premise_rect',\n      width: 40, \n      height: 40, \n      fill: '#ffffff00', \n      stroke: 'black', \n      strokeWidth: 0\n    },\n    text: {\n      class: 'premise_text',\n      text: 'P',\n      fontSize: 50,\n      'ref-x': 0.5,\n      'ref-y': 0.5,\n      ref: 'rect',\n      'x-alignment': 'middle',\n      'y-alignment': 'middle'\n    }\n  }\n}\n\nexport class Premise extends joint.dia.Element {\n    defaults() {\n        return {\n            ...super.defaults,\n            type: \"dia.Element.Premise\",\n            attrs: {\n                rect: PREMISE_DEFAULTS.attrs.rect,\n                text: PREMISE_DEFAULTS.attrs.text\n            }\n        }\n    }\n\n    markup = [{\n        tagName: \"rect\",\n        selector: \"body\"\n    },{\n        tagName: \"text\",\n        selector: \"label\"\n    }]\n\n    //custom constructor for shape, should more or less always use this over the default constructor\n    create(config) {\n\n        const options = _.cloneDeep(PREMISE_DEFAULTS);\n\n        if (config) {\n          options.position = Object.assign(options.position, config.position);\n          options.size = Object.assign(options.size, config.size);\n          options.attrs.rect = Object.assign(options.attrs.rect, config.attrs && config.attrs.rect);\n          options.attrs.text = Object.assign(options.attrs.text, config.attrs && config.attrs.text);\n        }\n\n        let premise = new Premise({\n          markup: '<g class=\"rotatable\"><g class=\"scalable\"><rect/></g><text/></g>',\n          position: {\n              ...options.position\n          },\n          size: {\n              ...options.size\n          },\n          attrs: {\n              rect: {\n                  ...options.attrs.rect\n              },\n              text: {\n                  ...options.attrs.text\n              },\n              level: 0\n          },\n          // set custom attributes here:\n        });\n        console.log(premise);\n        premise.addTo(graph)\n        //add tools (some events events also)\n        addPremiseTools(premise)\n        handleCollisions(premise)\n\n        // Play pop sound\n        let pop = new Audio(Pop); \n        pop.play();\n        return premise;\n    }\n\n    destroy() {\n      this.remove();\n    }\n  \n    active() {\n      return;\n    }\n\n    inactive(){\n      return;\n    }\n\n}\n\nObject.assign(joint.shapes, {\n    \"dia.Element\": {\n        Premise\n    }\n})\n\n","import * as joint from \"jointjs\"\nimport { paper } from \"../index.js\"\n\nexport function addPremiseTools(element) {\n    //element view is in charge of rendering the elements on the paper\n    let elementView = element.findView(paper);\n    //clear any old tools\n    elementView.removeTools();\n    // boundary tool shows boundaries of element\n    let boundaryTool = new joint.elementTools.Boundary();\n\n    let rect_tools = [boundaryTool];\n\n    let toolsView = new joint.dia.ToolsView({\n        tools: rect_tools\n    });\n\n    elementView.addTools(toolsView);\n    //start with tools hidden\n    elementView.hideTools();\n    // element.on(\"change:position\", function (eventView) {\n    //     element.toFront();\n    // });\n    // --- end of paper events -----\n}\n\n","import { graph } from '../index.js'\nimport { treeMove } from './treeUtil.js';\nimport { handleCollisions } from './collisions.js';\nimport _ from 'lodash'\n\nexport function addSubgraph(subgraph, position) {\n\n    let root = subgraph[Object.keys(subgraph)[0]];\n    let root_clone = root.clone();\n    let new_root = subgraphToGraph(root, root_clone, subgraph)\n    treeMove(new_root, position);\n    handleCollisions(new_root);\n}\n\nexport function subgraphToGraph(node, clone, subgraph, parent=null) {\n    clone.addTo(graph);\n    if (parent != null) {\n        parent.embed(clone);\n    }\n    let embeds = node.get('embeds');\n    if (embeds){\n        for (const embed of embeds) {\n            let child = findCellInSubgraph(embed, subgraph);\n            subgraphToGraph(child, child.clone(), subgraph, clone);\n        }\n    }\n    return clone;\n}\n\nfunction findCellInSubgraph(id, subgraph) {\n    let keys = Object.keys(subgraph);\n    for (const key of keys) {\n        let cell = subgraph[key];\n        if (cell.id === id) {\n            return cell;\n        }\n    }\n    alert(\"find subgraph failed!\");\n    return null\n}","export default __webpack_public_path__ + \"static/media/delete.775131a8.wav\";","import ReactDOM from 'react-dom';\nimport * as joint from 'jointjs';\nimport App from './components/App/App';\nimport { Premise } from './shapes/Premise/Premise';\nimport { Cut } from './shapes/Cut/Cut.js'\nimport $ from 'jquery'\nimport  _  from 'lodash'\nimport  { handleCollisions, treeToFront } from './util/collisions.js'\nimport { findRoot } from './util/treeUtil.js'\nimport { addSubgraph } from './util/otherUtil.js'\nimport Delete from './sounds/delete.wav'\nimport { insertDoubleCut } from './util/proof-util';\n\n\nconsole.log(\"Starting...\");\nwindow.joint = joint;\n\nwindow.action = null; \nwindow.mode = 'create';\n\nconst NSPremise = joint.dia.Element.define('nameSpace.Premise',Premise);\nconst NSCut = joint.dia.Element.define('nameSpace.Cut',Cut);\n\nReactDOM.render(\n    <App/>,\n    document.getElementById('root')\n);\n\nlet selected_premise = undefined;\nlet saved_template = undefined;\n\nexport let graph = new joint.dia.Graph({},{cellNamespace: \n    {\n    nameSpace: { Premise: NSPremise,\n                 Cut: NSCut }\n  }\n});\n\nconst PAPER_SIZE = { width: 4000, height: 4000 };\n\nexport let paper = new joint.dia.Paper({\n    el: document.getElementById(\"paper-container\"),\n    model: graph,\n    height: PAPER_SIZE.height,\n    width: PAPER_SIZE.width,\n    preventContextMenu: false,\n    clickThreshold: 1,\n},\n{cellViewNamespace: \n    {\n    nameSpace: { Premise: NSPremise,\n                 Cut: NSCut }\n  }});\n\nlet rect = new Premise().create()\nrect.position(100, 30);\n\nlet mousePosition = {\n    x: 0,\n    y: 0\n}\n\nconst paperContainer = document.getElementById('paper-container');\n\n\nconst keys = [];\nlet mouse_down = false;\nlet temp_cut = undefined;\nlet initial_cut_pos = {}\n\n$(document).on('keydown', function(event) {\n    keys[event.which] = true;\n    if(window.mode === 'create'){\n        if (keys[16]) {\n            paper.setInteractivity(false);\n        }\n    }\n});\n\ndocument.addEventListener(\"mousemove\", function(evt){\n    mousePosition = {\n        x: evt.clientX,\n        y: evt.clientY\n    }\n\n    if(window.mode === 'create'){\n        if (mouse_down && keys[16] && temp_cut) {\n            const mouse_adjusted = {\n                x: mousePosition.x - paperContainer.getBoundingClientRect().left,\n                y: mousePosition.y - paperContainer.getBoundingClientRect().top\n            };\n            temp_cut.set('position', {\n                x: Math.min(mouse_adjusted.x, initial_cut_pos.x),\n                y: Math.min(mouse_adjusted.y, initial_cut_pos.y)\n            })\n            temp_cut.attr('rect/width', Math.abs(mouse_adjusted.x - initial_cut_pos.x));\n            temp_cut.attr('rect/height', Math.abs(mouse_adjusted.y - initial_cut_pos.y));\n        }\n    }\n})\n\n$(document).on('mousedown', function(event) {\n    mouse_down = true;\n    if (keys[16] && window.mode === 'create') {\n\n        initial_cut_pos = Object.assign({}, mousePosition);\n        initial_cut_pos.x -= paperContainer.getBoundingClientRect().left;\n        initial_cut_pos.y -= paperContainer.getBoundingClientRect().top;\n        let config  = {\n            position: Object.assign({}, initial_cut_pos),\n            size: {width: 0, height: 0}\n        }\n        temp_cut = new Cut().create(config);\n        temp_cut.active()\n        event.preventDefault();\n    }\n});\n\n$(document).on('mouseup', function(event) {\n    mouse_down = false;\n    if (window.mode === 'proof') {\n        if (!selected_premise && window.action && window.action.name === 'insertDoubleCut') {\n            const mouse_adjusted = {\n                x: mousePosition.x - paperContainer.getBoundingClientRect().left,\n                y: mousePosition.y - paperContainer.getBoundingClientRect().top\n            };\n            window.action(null, mouse_adjusted);\n            window.action = null;\n        }\n    }\n    if (temp_cut && window.mode === 'create') {\n        const position = _.clone(temp_cut.get('position'));\n        const size = _.clone({width: temp_cut.attr('rect/width'), height: temp_cut.attr('rect/height')});\n        const config = {\n            position: position,\n            attrs:{\n                rect: {\n                    ...size\n                }\n            }\n        }\n        //eslint-disable-next-line\n        let new_rect = new Cut().create(config);\n        temp_cut.remove();\n    }\n\n    paper.setInteractivity(true);\n    temp_cut = undefined;\n});\n\n$(document).on('keyup', function(event){\n    if(window.mode === 'proof'){\n        if(window.action && window.action.name === 'inferenceInsertion') {\n            if (!selected_premise) return;\n            if (selected_premise.attributes.attrs.level % 2 === 1) return;\n            if (event.keyCode >= 65 && event.keyCode <= 90) {\n                let config = {\n                    //use capital letters by default, can press shift to make lowercase\n                    attrs:{\n                        text: {\n                            text:event.shiftKey ? event.key.toLocaleLowerCase() : event.key.toLocaleUpperCase()\n                        }\n                    },\n                    position: {\n                        x: mousePosition.x - paperContainer.getBoundingClientRect().left - 20,\n                        y: mousePosition.y - paperContainer.getBoundingClientRect().top - 20\n                    }\n                }\n                //eslint-disable-next-line\n                let new_rect = new Premise().create(config)\n            }\n            window.action = null;\n        }\n        return;\n    }\n    console.log(event.which);\n    keys[event.which] = false;\n    let key = event.key\n    //backspace (delete premise or cut)\n    if (event.keyCode === 8 ) {\n        if (selected_premise) {\n            let delete_noise = new Audio(Delete); \n            if (selected_premise.attributes.type === \"dia.Element.Premise\") {\n                selected_premise.destroy()\n                delete_noise.play();\n            } else if (selected_premise.attributes.type === \"dia.Element.Cut\") {\n                selected_premise.destroy();        // Play pop sound\n                delete_noise.play();\n            } else {\n                console.error(\"attempted to delete shape of unknown type: \" + selected_premise.attributes.type)\n            }\n        }\n        selected_premise = undefined;\n    }\n    //a-z for creating premise\n    if (event.keyCode >= 65 && event.keyCode <= 90) {\n        let config = {\n            //use capital letters by default, can press shift to make lowercase\n            attrs:{\n                text: {\n                    text:event.shiftKey ? key.toLocaleLowerCase() : key.toLocaleUpperCase()\n                }\n            },\n            position: {\n                x: mousePosition.x - paperContainer.getBoundingClientRect().left - 20,\n                y: mousePosition.y - paperContainer.getBoundingClientRect().top - 20\n            }\n        }\n        //eslint-disable-next-line\n        let new_rect = new Premise().create(config)\n    }\n    //ENTER\n    // new cut\n    if (event.keyCode === 13) {\n        let config = {\n            position: {\n                x: mousePosition.x - paperContainer.getBoundingClientRect().left - 20,\n                y: mousePosition.y - paperContainer.getBoundingClientRect().top - 20\n            }\n        }\n        if (selected_premise) {\n            config[\"child\"] = selected_premise\n            let new_cut = new Cut().create(config)\n        } else {\n            console.log(\"creating empty cut\")\n            let new_cut = new Cut().create(config)\n            console.log(\"cut\", new_cut)\n        }\n    }\n\n    if (event.keyCode === 49) {\n        //save template\n        if (selected_premise) {\n            saved_template = graph.cloneSubgraph([selected_premise], {deep: true});\n        }\n    }\n\n    if (event.keyCode === 50) {\n        let position = {\n            x: mousePosition.x - paperContainer.getBoundingClientRect().left - 20,\n            y: mousePosition.y - paperContainer.getBoundingClientRect().top - 20\n        }\n        console.log(\"position\", position)\n        if (saved_template) {\n            addSubgraph(saved_template, position);\n        }\n    }\n    event.preventDefault()\n});\n\n\n\n// paper events\npaper.on(\"element:mouseenter\", function( cellView, evt){\n    let model = cellView.model\n    let modelView = model.findView(paper);\n    modelView.showTools()\n    model.attr(\"rect/stroke\", \"red\")\n    model.attr(\"text/fill\", \"red\")\n    selected_premise = model\n})\n\npaper.on(\"element:mouseleave\", function( cellView, evt){\n    let model = cellView.model\n    let modelView = model.findView(paper);\n    if(!modelView) return;\n    modelView.hideTools()\n    model.attr(\"rect/stroke\", \"black\")\n    model.attr(\"text/fill\", \"black\")\n    selected_premise = undefined;\n})\n\n// First, unembed the cell that has just been grabbed by the user.\npaper.on('cell:pointerdown', function(cellView, evt, x, y) {\n    \n    let cell = cellView.model;\n\n    if (!cell.get('embeds') || cell.get('embeds').length === 0) {\n        // Show the dragged element above all the other cells (except when the\n        // element is a parent).\n        cell.toFront();\n    }\n    \n    if (cell.get('parent')) {\n        graph.getCell(cell.get('parent')).unembed(cell);\n    }\n\n    cell.active();\n    treeToFront(findRoot(cell));\n});\n\n// When the dragged cell is dropped over another cell, let it become a child of the\n// element below.\npaper.on('cell:pointerup', function(cellView, evt, x, y) {\n\n    let cell = cellView.model;\n    \n    handleCollisions(cell)\n    cell.inactive();\n\n    if (window.action) window.action(cell);\n    window.action = null;\n});"],"sourceRoot":""}
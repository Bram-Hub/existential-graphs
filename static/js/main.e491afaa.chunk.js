(this["webpackJsonpexistential-graphs"]=this["webpackJsonpexistential-graphs"]||[]).push([[0],{67:function(t,e,a){},69:function(t,e,a){},75:function(t,e,a){},78:function(t,e,a){},79:function(t,e,a){},80:function(t,e,a){},86:function(t,e,a){},87:function(t,e,a){},88:function(t,e,a){},89:function(t,e,a){},90:function(t,e,a){},92:function(t,e,a){"use strict";a.r(e);var n=a(70),i=a.n(n),r=a(37),o=a(16),s=a(17),c=a(22),l=a(21),h=a(9),u=a.n(h),d=(a(75),a(67),a(3));function p(t){var e="\n    .cls-1{\n      fill:#ed6b4d;\n      stroke:#e2f3f7;\n      stroke-miterlimit:10;\n      stroke-width:12px;\n    }\n    .cls-2 {\n      fill:#e2f3f7;\n    }\n  ",a={"./MenuIcons/logo.png":Object(d.jsxs)("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 841.23 762.74",width:"8vh",height:"8vh",children:[Object(d.jsx)("defs",{children:Object(d.jsx)("style",{children:e})}),Object(d.jsx)("path",{className:"cls-1",d:"M1022,769v96.74q0,19.28-3.79,30.81a49,49,0,0,1-13.94,20.83q-10.17,9.28-26,17.9Q932.46,960,890.12,971.41t-92.27,11.36q-58.17,0-106-17.91t-81.58-52q-33.75-34.08-51.81-82.62Q543.75,790.83,541,743.9c-1,0-1.92,0-2.9,0H256.29q-33.87,0-48.71-15t-14.84-48.54V295.58q0-22.33,6.63-36.49a41.18,41.18,0,0,1,20.78-20.6Q234.3,232,256.29,232H530.06q24.78,0,36.84,11t12,28.81q0,18.15-12,29.15t-36.84,11H296.45V437.7h215.1q23.74,0,35.44,10.65t11.7,28.11q0,17.48-11.52,28.46t-35.62,11H296.45V661.53H538.09q3.76,0,7.26.27a287.88,287.88,0,0,1,12.56-47.73q17.55-48.89,51.64-83t83-52.15q48.88-18.07,110.85-18.08,51,0,90.2,13.6t63.69,34.25q24.43,20.67,36.83,43.73t12.39,41q0,19.29-14.28,32.88a47.94,47.94,0,0,1-34.26,13.6,46.05,46.05,0,0,1-21.17-5.17,48,48,0,0,1-17-14.46q-18.93-29.6-32-44.75T852.42,550q-22.2-10.34-56.63-10.33-35.46,0-63.34,12.22a130.87,130.87,0,0,0-47.68,35.46q-19.8,23.24-30.3,57T644,719.07q0,88.81,40.8,136.67t113.77,47.85a231.88,231.88,0,0,0,66.62-9.3,337.73,337.73,0,0,0,63.17-26.51V785.85H849.15q-28.57,0-43.21-8.61T791.31,748q0-16.86,12.22-27.88t33.22-11h116q21.35,0,36.15,3.79a40.81,40.81,0,0,1,23.92,16.87Q1022,742.82,1022,769Z",transform:"translate(-186.74 -226.03)"})]}),"./MenuIcons/export.png":Object(d.jsxs)("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 841.24 898.25",width:"4vh",height:"4vh",children:[Object(d.jsx)("defs",{children:Object(d.jsx)("style",{children:e})}),Object(d.jsx)("path",{className:"cls-2",d:"M1020.62,789.78v249a40.18,40.18,0,0,1-40.18,40.17H219.56a40.18,40.18,0,0,1-40.18-40.17v-249a40.18,40.18,0,0,1,40.18-40.18h58.25A40.18,40.18,0,0,1,318,789.78V940.34H882V789.78a40.18,40.18,0,0,1,40.17-40.18h58.25A40.18,40.18,0,0,1,1020.62,789.78Z",transform:"translate(-179.38 -180.69)"}),Object(d.jsx)("path",{className:"cls-2",d:"M384.19,390.1,533.64,240.66l48.21-48.21a38.5,38.5,0,0,1,55.4,0l48.22,48.22L834.9,390.1a40.17,40.17,0,0,1,0,56.81L793.71,488.1a40.17,40.17,0,0,1-56.81,0L679,430.18V751.79A40.18,40.18,0,0,1,638.81,792H580.55a40.18,40.18,0,0,1-40.17-40.17V429.91L482.19,488.1a40.17,40.17,0,0,1-56.81,0l-41.19-41.19A40.17,40.17,0,0,1,384.19,390.1Z",transform:"translate(-179.38 -180.69)"}),Object(d.jsx)("path",{className:"cls-2",d:"M665.69,620.82a40.39,40.39,0,0,1-5.61,7L618.9,669a40.08,40.08,0,0,1-29.11,11.76A40,40,0,0,0,617.48,669Z",transform:"translate(-179.38 -180.69)"}),Object(d.jsx)("path",{className:"cls-2",d:"M589.79,680.79A40,40,0,0,1,560.67,669l-41.19-41.19a40.14,40.14,0,0,1-5.62-7L562.08,669A40,40,0,0,0,589.79,680.79Z",transform:"translate(-179.38 -180.69)"})]}),"./MenuIcons/import.png":Object(d.jsxs)("svg",{id:"Layer_1","data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 841.24 898.26",width:"4vh",height:"4vh",children:[Object(d.jsx)("defs",{children:Object(d.jsx)("style",{children:e})}),Object(d.jsx)("path",{className:"cls-2",d:"M1020.62,789.78v249a40.18,40.18,0,0,1-40.18,40.17H219.56a40.18,40.18,0,0,1-40.18-40.17v-249a40.18,40.18,0,0,1,40.18-40.18h58.25A40.18,40.18,0,0,1,318,789.78V940.34H882V789.78a40.18,40.18,0,0,1,40.17-40.18h58.25A40.18,40.18,0,0,1,1020.62,789.78Z",transform:"translate(-179.38 -180.68)"}),Object(d.jsx)("path",{className:"cls-2",d:"M834.91,582.54,685.46,732l-48.21,48.21a38.5,38.5,0,0,1-55.4,0L533.63,732,384.2,582.54a40.17,40.17,0,0,1,0-56.81l41.19-41.19a40.17,40.17,0,0,1,56.81,0l57.92,57.92V220.85a40.18,40.18,0,0,1,40.17-40.17h58.26a40.18,40.18,0,0,1,40.17,40.17V542.73l58.19-58.19a40.17,40.17,0,0,1,56.81,0l41.19,41.19A40.17,40.17,0,0,1,834.91,582.54Z",transform:"translate(-179.38 -180.68)"}),Object(d.jsx)("path",{className:"cls-2",d:"M665.69,620.82a40.39,40.39,0,0,1-5.61,7L618.9,669a40.08,40.08,0,0,1-29.11,11.76A40,40,0,0,0,617.48,669Z",transform:"translate(-179.38 -180.68)"}),Object(d.jsx)("path",{className:"cls-2",d:"M589.79,680.79A40,40,0,0,1,560.67,669l-41.19-41.19a40.14,40.14,0,0,1-5.62-7L562.08,669A40,40,0,0,0,589.79,680.79Z",transform:"translate(-179.38 -180.68)"})]}),muted:Object(d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 576 512",children:Object(d.jsx)("path",{d:"M301.2 34.85c-11.5-5.188-25.02-3.122-34.44 5.253L131.8 160H48c-26.51 0-48 21.49-48 47.1v95.1c0 26.51 21.49 47.1 48 47.1h83.84l134.9 119.9c5.984 5.312 13.58 8.094 21.26 8.094c4.438 0 8.972-.9375 13.17-2.844c11.5-5.156 18.82-16.56 18.82-29.16V64C319.1 51.41 312.7 40 301.2 34.85zM513.9 255.1l47.03-47.03c9.375-9.375 9.375-24.56 0-33.94s-24.56-9.375-33.94 0L480 222.1L432.1 175c-9.375-9.375-24.56-9.375-33.94 0s-9.375 24.56 0 33.94l47.03 47.03l-47.03 47.03c-9.375 9.375-9.375 24.56 0 33.94c9.373 9.373 24.56 9.381 33.94 0L480 289.9l47.03 47.03c9.373 9.373 24.56 9.381 33.94 0c9.375-9.375 9.375-24.56 0-33.94L513.9 255.1z",style:{fill:"rgb(255, 255, 255)"}})}),unmuted:Object(d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 640 512",children:Object(d.jsx)("path",{d:"M412.6 182c-10.28-8.334-25.41-6.867-33.75 3.402c-8.406 10.24-6.906 25.35 3.375 33.74C393.5 228.4 400 241.8 400 255.1c0 14.17-6.5 27.59-17.81 36.83c-10.28 8.396-11.78 23.5-3.375 33.74c4.719 5.806 11.62 8.802 18.56 8.802c5.344 0 10.75-1.779 15.19-5.399C435.1 311.5 448 284.6 448 255.1S435.1 200.4 412.6 182zM473.1 108.2c-10.22-8.334-25.34-6.898-33.78 3.34c-8.406 10.24-6.906 25.35 3.344 33.74C476.6 172.1 496 213.3 496 255.1s-19.44 82.1-53.31 110.7c-10.25 8.396-11.75 23.5-3.344 33.74c4.75 5.775 11.62 8.771 18.56 8.771c5.375 0 10.75-1.779 15.22-5.431C518.2 366.9 544 313 544 255.1S518.2 145 473.1 108.2zM534.4 33.4c-10.22-8.334-25.34-6.867-33.78 3.34c-8.406 10.24-6.906 25.35 3.344 33.74C559.9 116.3 592 183.9 592 255.1s-32.09 139.7-88.06 185.5c-10.25 8.396-11.75 23.5-3.344 33.74C505.3 481 512.2 484 519.2 484c5.375 0 10.75-1.779 15.22-5.431C601.5 423.6 640 342.5 640 255.1S601.5 88.34 534.4 33.4zM301.2 34.98c-11.5-5.181-25.01-3.076-34.43 5.29L131.8 160.1H48c-26.51 0-48 21.48-48 47.96v95.92c0 26.48 21.49 47.96 48 47.96h83.84l134.9 119.8C272.7 477 280.3 479.8 288 479.8c4.438 0 8.959-.9314 13.16-2.835C312.7 471.8 320 460.4 320 447.9V64.12C320 51.55 312.7 40.13 301.2 34.98z",style:{fill:"rgb(255, 255, 255)"}})}),settings:Object(d.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 512 512",children:Object(d.jsx)("path",{d:"M495.9 166.6C499.2 175.2 496.4 184.9 489.6 191.2L446.3 230.6C447.4 238.9 448 247.4 448 256C448 264.6 447.4 273.1 446.3 281.4L489.6 320.8C496.4 327.1 499.2 336.8 495.9 345.4C491.5 357.3 486.2 368.8 480.2 379.7L475.5 387.8C468.9 398.8 461.5 409.2 453.4 419.1C447.4 426.2 437.7 428.7 428.9 425.9L373.2 408.1C359.8 418.4 344.1 427 329.2 433.6L316.7 490.7C314.7 499.7 307.7 506.1 298.5 508.5C284.7 510.8 270.5 512 255.1 512C241.5 512 227.3 510.8 213.5 508.5C204.3 506.1 197.3 499.7 195.3 490.7L182.8 433.6C167 427 152.2 418.4 138.8 408.1L83.14 425.9C74.3 428.7 64.55 426.2 58.63 419.1C50.52 409.2 43.12 398.8 36.52 387.8L31.84 379.7C25.77 368.8 20.49 357.3 16.06 345.4C12.82 336.8 15.55 327.1 22.41 320.8L65.67 281.4C64.57 273.1 64 264.6 64 256C64 247.4 64.57 238.9 65.67 230.6L22.41 191.2C15.55 184.9 12.82 175.3 16.06 166.6C20.49 154.7 25.78 143.2 31.84 132.3L36.51 124.2C43.12 113.2 50.52 102.8 58.63 92.95C64.55 85.8 74.3 83.32 83.14 86.14L138.8 103.9C152.2 93.56 167 84.96 182.8 78.43L195.3 21.33C197.3 12.25 204.3 5.04 213.5 3.51C227.3 1.201 241.5 0 256 0C270.5 0 284.7 1.201 298.5 3.51C307.7 5.04 314.7 12.25 316.7 21.33L329.2 78.43C344.1 84.96 359.8 93.56 373.2 103.9L428.9 86.14C437.7 83.32 447.4 85.8 453.4 92.95C461.5 102.8 468.9 113.2 475.5 124.2L480.2 132.3C486.2 143.2 491.5 154.7 495.9 166.6V166.6zM256 336C300.2 336 336 300.2 336 255.1C336 211.8 300.2 175.1 256 175.1C211.8 175.1 176 211.8 176 255.1C176 300.2 211.8 336 256 336z",style:{fill:"rgb(255, 255, 255)"}})})},n=""===t.img?"100%":"70%",i=t.custom_style;return Object(d.jsxs)("div",{style:i,className:"menu-item ".concat(t.classString||""),onClick:t.onClick,"aria-label":t.label,children:[a[t.img],Object(d.jsx)("h4",{className:"menu-item-label",style:{fontSize:n},children:t.text})]})}function f(t){var e={left:[{text:"",img:"./MenuIcons/logo.png",onClick:function(){window.open("https://github.com/eddiekrystowski/existential-graphs")},custom_style:{marginLeft:"0vw"}},{text:"Existential Graphs",img:"",onClick:function(){},custom_style:{marginLeft:"1vw"}},{text:"Import",img:"./MenuIcons/import.png",onClick:t.importMainGraph,custom_style:{marginLeft:"10vw"}},{text:"Export",img:"./MenuIcons/export.png",onClick:t.exportMainGraph,custom_style:{marginLeft:"5vw"}}],right:[{text:t.muted?"Muted":"Unmuted",label:"Toggle Sound",classString:t.muted?"muted":"unmuted",img:t.muted?"muted":"unmuted",onClick:t.handleMuteToggle,custom_style:{marginLeft:"5vw"}},{text:"Settings",img:"settings",onClick:function(){},custom_style:{marginLeft:"5vw",height:"4vw",width:"4vw"}}]};return Object(d.jsxs)("div",{className:"header-bar",children:[Object(d.jsx)("div",{className:"header-bar-left",children:e.left.map((function(t){return Object(d.jsx)(p,{text:t.text,img:t.img,classString:t.classString,onClick:t.onClick,custom_style:t.custom_style,label:t.label},t.text)}))}),Object(d.jsx)("div",{className:"header-bar-right",children:e.right.map((function(t){return Object(d.jsx)(p,{text:t.text,img:t.img,classString:t.classString,onClick:t.onClick,custom_style:t.custom_style,label:t.label},t.text)}))})]})}var g=a(31),m=a(41),v=a(29),b=a(4),y=a.n(b),x=new(function(){function t(){Object(o.a)(this,t),this.mousePosition={x:0,y:0},this.keys=[],this.which=0,this.key="",this.isMouseDown=!1}return Object(s.a)(t,[{key:"isActive",value:function(t){return this.key.toLocaleLowerCase()===t||this.which===t||!0===this.keys[t]}}]),t}());y()(document).on("keydown",(function(t){x.keys[t.which]=!0,x.which=t.which,x.key=t.key})),y()(document).on("keyup",(function(t){x.keys[t.which]=!1,x.which=t.which,x.key=t.key})),y()(document).on("mousemove",(function(t){x.mousePosition={x:t.clientX,y:t.clientY}})),y()(document).on("mousedown",(function(t){x.isMouseDown=!0})),y()(document).on("mouseup",(function(t){x.isMouseDown=!1}));var j=x,C=a(7),k=a.n(C),O=a.p+"static/media/delete.775131a8.wav",w=a(19),_=a(24),M=a(64),P=a(38),A=a.p+"static/media/snip.6f2bc4d7.wav",E={background:{odd:{inactive:"#f2f8fc",active:"#f2f8fcE0"},even:{inactive:"#ffffff",active:"#ffffffE0"},default:{color:"#ffffff00"}}},S={position:{x:10,y:10},size:{width:40,height:40},attrs:{rect:{class:"cut_rect",width:40,height:40,fill:"#ffffff99",stroke:"black",strokeWidth:2},text:{class:"cut_text",fontSize:30,"ref-x":.5,"ref-y":.5,ref:"rect","y-alignment":"middle","x-alignment":"middle"}},graph:{}},B=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(){var t;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))).markup=[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],t}return Object(s.a)(a,[{key:"defaults",value:function(){return Object(g.a)(Object(g.a)({},Object(M.a)(Object(P.a)(a.prototype),"defaults",this)),{},{type:"dia.Element.Cut",attrs:{rect:S.attrs.rect,text:S.attrs.text}})}},{key:"create",value:function(t,e){var n=k.a.cloneDeep(S);if(t&&(n.position=Object.assign(n.position,t.position),n.size=Object.assign(n.size,t.size),n.attrs.rect=Object.assign(n.attrs.rect,t.attrs&&t.attrs.rect),n.attrs.text=Object.assign(n.attrs.text,t.attrs&&t.attrs.text)),n.sheet=e,t.child){var i=t.child;n.attrs.rect.width=i.attributes.attrs.rect.width+n.attrs.rect.width,n.attrs.rect.height=i.attributes.attrs.rect.height+n.attrs.rect.height,n.position={x:i.attributes.position.x-(n.attrs.rect.width-i.attributes.attrs.rect.width)/2,y:i.attributes.position.y-(n.attrs.rect.height-i.attributes.attrs.rect.height)/2}}var r=new a({markup:"<rect/><text/>",position:Object(g.a)({},n.position),size:Object(g.a)({},n.size),attrs:{rect:Object(g.a)({},n.attrs.rect),text:Object(g.a)({},n.attrs.text),level:0},sheet:n.sheet});if(r.sheet=n.sheet,r.addTo(r.sheet.graph),this.addTools(r),new Audio(A).play(),t&&t.child){var o=t.child,s=!1;if(o.get("parent")){var c=r.sheet.graph.getCell(o.get("parent"));c.unembed(o),c.embed(r),c.toBack(),s=!0}r.embed(o),s&&r.sheet.treeResize(r,r.attributes.attrs.rect.width/2)}return r}},{key:"destroy",value:function(){var t,e=this.getParentCell(),a=this.getEmbeddedCells(),n=Object(_.a)(a);try{for(n.s();!(t=n.n()).done;){var i=t.value;this.unembed(i)}}catch(r){n.e(r)}finally{n.f()}this.remove(),e&&this.sheet.handleCollisions(e),this.sheet.paper.handleDeleteCell()}},{key:"obliterate",value:function(){var t=this,e=this.attributes.embeds;e&&e.forEach((function(e){t.sheet.graph.getCell(e).obliterate()})),this.destroy()}},{key:"active",value:function(){this.sheet.colorByLevel(this,{even:E.background.even.active,odd:E.background.odd.active,premise:E.background.default.color})}},{key:"inactive",value:function(){this.sheet.colorByLevel(this,{even:E.background.even.inactive,odd:E.background.odd.inactive,premise:E.background.default.color})}},{key:"getBoundingBox",value:function(){return{width:this.attributes.attrs.rect.width,height:this.attributes.attrs.rect.height,x:this.attributes.position.x,y:this.attributes.position.y}}},{key:"getArea",value:function(){return this.attributes.attrs.rect.width*this.attributes.attrs.rect.height}},{key:"addTools",value:function(t){var e=t.findView(t.sheet.paper.jpaper);e.removeTools();var a=new v.g.Boundary,n=new v.g.Button(G({x:"0%",y:"0%",cursor:"nw-resize"})),i=new v.g.Button(G({x:"100%",y:"0%",cursor:"ne-resize"})),r=new v.g.Button(G({x:"0%",y:"100%",cursor:"sw-resize"})),o=new v.g.Button(G({x:"100%",y:"100%",cursor:"se-resize"}));y()(n.el).on("mousedown",R.bind(t)),y()(i.el).on("mousedown",R.bind(t)),y()(r.el).on("mousedown",R.bind(t)),y()(o.el).on("mousedown",R.bind(t));var s=[a,n,i,o,r],c=new v.f.ToolsView({tools:s});e.addTools(c),e.hideTools()}}]),a}(v.f.Element);Object.assign(r,{"dia.Element":{Cut:B}});var L={x:0,y:0},N={x:0,y:0},z=40,I=40;function R(t){var e=this.sheet.graph.getCell(y()(t.target).parent().attr("model-id"));L={x:t.clientX,y:t.clientY},y()(document).on("mouseup",{target:e},D),y()(document).on("mousemove",{target:e,direction:t.target.getAttribute("data-direction")},T),t.stopPropagation(),e.get("parent")&&this.sheet.graph.getCell(e.get("parent")).unembed(e)}function T(t){N={x:t.clientX,y:t.clientY};var e=t.data.target.attributes.attrs.rect.width,a=t.data.target.attributes.attrs.rect.height,n=t.data.target.attributes.position.x,i=t.data.target.attributes.position.y,r={x:N.x-L.x,y:N.y-L.y},o={size_x:1,size_y:1,pos_x:0,pos_y:0};switch(t.data.direction){case"nw":o.size_x=-1,o.size_y=-1,o.pos_x=1,o.pos_y=1;break;case"ne":o.size_x=1,o.size_y=-1,o.pos_x=0,o.pos_y=1;break;case"sw":o.size_x=-1,o.size_y=1,o.pos_x=1,o.pos_y=0;break;case"se":o.size_x=1,o.size_y=1,o.pos_x=0,o.pos_y=0;break;default:throw new RangeError("Invalid direction value. Expected nw, ne, sw, se. Got "+t.data.direction)}e+o.size_x*r.x<z&&(r.x=0),a+o.size_y*r.y<I&&(r.y=0),t.data.target.attr("rect/width",e+o.size_x*r.x),t.data.target.attr("rect/height",a+o.size_y*r.y),t.data.target.set("position",{x:n+o.pos_x*r.x,y:i+o.pos_y*r.y}),L=Object.assign({},N)}function D(t){y()(document).off("mouseup",D),y()(document).off("mousemove",T),t.data.target.sheet.handleCollisions(t.data.target),t.data.target.sheet.paper.onGraphUpdate()}function G(t){var e=t&&t.r||7,a=t&&t.fill||"transparent",n=t&&t.x||"0%",i=t&&t.y||"0%",r=t&&t.offset||{x:0,y:0},o=t&&t.cursor||"nw-resize";return{markup:[{tagName:"circle",selector:"button",attributes:{r:e,fill:a,cursor:o,"data-direction":o.substring(0,2)}}],x:n,y:i,offset:r,rotate:!0}}a(78);var U={position:{x:10,y:10},size:{width:40,height:40},attrs:{rect:{class:"premise_rect",width:40,height:40,fill:"#ffffff00",stroke:"black",strokeWidth:0},text:{class:"premise_text",text:"P",fontSize:50,"ref-x":.5,"ref-y":.5,ref:"rect","x-alignment":"middle","y-alignment":"middle"}},graph:{}},J=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(){var t;Object(o.a)(this,a);for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return(t=e.call.apply(e,[this].concat(i))).markup=[{tagName:"rect",selector:"body"},{tagName:"text",selector:"label"}],t}return Object(s.a)(a,[{key:"defaults",value:function(){return Object(g.a)(Object(g.a)({},Object(M.a)(Object(P.a)(a.prototype),"defaults",this)),{},{type:"dia.Element.Premise",attrs:{rect:U.attrs.rect,text:U.attrs.text}})}},{key:"create",value:function(t,e,n){var i=k.a.cloneDeep(U);t&&(i.position=Object.assign(i.position,t.position),i.size=Object.assign(i.size,t.size),i.attrs.rect=Object.assign(i.attrs.rect,t.attrs&&t.attrs.rect),i.attrs.text=Object.assign(i.attrs.text,t.attrs&&t.attrs.text)),i.sheet=e;var r=new a({markup:'<g class="rotatable"><rect/><text/></g>',position:Object(g.a)({},i.position),size:Object(g.a)({},i.size),attrs:{rect:Object(g.a)({},i.attrs.rect),text:Object(g.a)({},i.attrs.text),level:0}});return r.sheet=i.sheet,r.addTo(r.sheet.graph),n||this.addTools(r),r}},{key:"destroy",value:function(){this.remove(),this.sheet.paper.handleDeleteCell()}},{key:"obliterate",value:function(){this.destroy()}},{key:"active",value:function(){}},{key:"inactive",value:function(){}},{key:"getBoundingBox",value:function(){return{width:this.attributes.attrs.rect.width,height:this.attributes.attrs.rect.height,x:this.attributes.position.x,y:this.attributes.position.y}}},{key:"getArea",value:function(){return this.attributes.attrs.rect.width*this.attributes.attrs.rect.height}},{key:"addTools",value:function(t){var e=t.findView(t.sheet.paper.jpaper);e.removeTools();var a=[new v.g.Boundary],n=new v.f.ToolsView({tools:a});e.addTools(n),e.hideTools()}}]),a}(v.f.Element);function V(t){if(0!==t.length){var e,a=t[0].attributes.attrs.rect.width*t[0].attributes.attrs.rect.height,n=t[0],i=Object(_.a)(t);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=r.attributes.attrs.rect.width*r.attributes.attrs.rect.height;o<a&&(a=o,n=r)}}catch(s){i.e(s)}finally{i.f()}return n}}function q(t,e){var a=t.x,n=t.x+t.width,i=t.y,r=t.y+t.height,o=e.x,s=e.x+e.width,c=e.y,l=e.y+e.height;return a<o&&n>s&&i<c&&r>l}function H(t,e){var a,n=[],i=Object(_.a)(e);try{for(i.s();!(a=i.n()).done;){var r=a.value;t.id!==r.id&&(F(t.getBoundingBox(),r.getBoundingBox())&&n.push(r))}}catch(o){i.e(o)}finally{i.f()}return n}function F(t,e){return!(!q(t,e)&&!q(e,t))||!(t.y+t.height<e.y||e.y+e.height<t.y)&&!(t.x+t.width<e.x||e.x+e.width<t.x)}Object.assign(r.shapes,{"dia.Element":{Premise:J}});var K=a.p+"static/media/pop.cddf7df9.wav";function Z(t,e){var a,n=Object(_.a)(e);try{for(n.s();!(a=n.n()).done;){var i=a.value;if(t.id===i.id)return!0}}catch(r){n.e(r)}finally{n.f()}return!1}var X=v.f.Element.define("nameSpace.Premise",J),W=v.f.Element.define("nameSpace.Cut",B),Q={even:E.background.even.inactive,odd:E.background.odd.inactive,premise:E.background.default.color},Y=function(){function t(e){Object(o.a)(this,t),this.paper=e,this.handlePlayAudio=e.props.handlePlayAudio,this.graph=new v.f.Graph({},{cellNamespace:{nameSpace:{Premise:X,Cut:W}}}),this.spacing=10}return Object(s.a)(t,[{key:"addPremise",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=(new J).create(t,this,a);this.handleCollisions(n);var i=new Audio(K);return this.handlePlayAudio(i),this.paper.onGraphUpdate(),n}},{key:"addCut",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=(new B).create(t,this,e);e&&this.handleCollisions(a);var n=new Audio(A);return this.handlePlayAudio(n),this.paper.onGraphUpdate(),a}},{key:"importCells",value:function(t){var e=this;if(this.graph.clear(),"[]"!==t){var a=t.map((function(t){return(t=t.clone()).sheet=e,t}));this.graph.resetCells(a);var n,i=Object(_.a)(a);try{for(i.s();!(n=i.n()).done;){var r=n.value;this.handleCollisions(r,!1)}}catch(o){i.e(o)}finally{i.f()}}}},{key:"exportAsJSON",value:function(){var t=this.graph.getCells().map((function(t){return Object.assign(t.attributes,{sheet:null})}));return JSON.stringify(t,null,2)}},{key:"importFromJSON",value:function(t){var e,a=JSON.parse(t),n=Object(_.a)(a);try{for(n.s();!(e=n.n()).done;){var i=e.value,r=void 0;if("dia.Element.Premise"===i.type)r=this.addPremise(i,!0,!0);else{if("dia.Element.Cut"!==i.type)throw new RangeError("Cell type must be either dia.Element.Premise or dia.Element.Cut, got ".concat(i.type));r=this.addCut(i,!0,!0)}var o=y()('svg [model-id="'.concat(r.attributes.id,'"]'));o.trigger("mouseenter"),o.trigger("mouseleave")}}catch(s){n.e(s)}finally{n.f()}}},{key:"handleCollisions",value:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],a=t.getBoundingBox(),n=this.findPotentialParents(a),i=V(n);if(i){var r=this.filterChildren(i,a);i.embed(t);var o,s=Object(_.a)(r);try{for(s.s();!(o=s.n()).done;){var c=o.value;c.get("parent")&&i.unembed(c),t.embed(c)}}catch(p){s.e(p)}finally{s.f()}this.treeToFront(i)}else{var l,h=this.findElementsInside(a),u=Object(_.a)(h);try{for(u.s();!(l=u.n()).done;){var d=l.value;d.get("parent")||d.id===t.id||t.embed(d)}}catch(p){u.e(p)}finally{u.f()}this.treeToFront(t)}this.colorByLevel(t),e&&(this.pack(t),this.cleanOverlaps())}},{key:"pack",value:function(t){var e=this.findRoot(t);this.pack_rec(e)}},{key:"pack_rec",value:function(t){var e=t.getEmbeddedCells();if(0!==e.length){var a,n=Object(_.a)(e);try{for(n.s();!(a=n.n()).done;){var i=a.value;this.pack_rec(i)}}catch(s){n.e(s)}finally{n.f()}this.cleanOverlaps(e);var r=function(t){for(var e=t[0].attributes.position.x,a=t[0].attributes.attrs.rect.width+e,n=t[0].attributes.position.y,i=t[0].attributes.attrs.rect.height+n,r=1;r<t.length;r++){var o=t[r].getBoundingBox();o.x<e&&(e=o.x),o.y<n&&(n=o.y),o.x+o.width>a&&(a=o.x+o.width),o.y+o.height>i&&(i=o.y+o.height)}return{x:e,y:n,width:a-e,height:i-n}}(e),o=t.getBoundingBox();if(!q(o,r)){if(!F(o,r))return;(r.x<o.x||r.x+r.width>o.x+o.width)&&(t.position(r.x-this.spacing,t.attributes.position.y),t.attr("rect/width",r.width+2*this.spacing)),(r.y<o.y||r.y+r.height>o.y+o.height)&&(t.position(t.attributes.position.x,r.y-this.spacing),t.attr("rect/height",r.height+2*this.spacing))}}}},{key:"cleanOverlaps",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.getCellsByLevel(0);t.sort((function(t,e){return e.getArea()-t.getArea()}));for(var e=t;e.length>0;){var a,n=[],i=Object(_.a)(e);try{for(i.s();!(a=i.n()).done;){var r,o=a.value,s=H(o,t),c=Object(_.a)(s);try{for(c.s();!(r=c.n()).done;){var l=r.value;this.separate(o,l);var h=Z(l,n);h||n.push(l)}}catch(u){c.e(u)}finally{c.f()}}}catch(u){i.e(u)}finally{i.f()}e=n}}},{key:"separate",value:function(t,e){var a=t.getBoundingBox(),n=e.getBoundingBox(),i=a.x<n.x?a.x+a.width-n.x:a.x-n.x-n.width,r=a.y<n.y?a.y+a.height-n.y:a.y-n.y-n.height;if(Math.abs(i)>Math.abs(r)){var o=Math.sign(r);0===o&&(o=1),this.treeMove(e,{x:n.x,y:n.y+r+this.spacing*o})}else{var s=Math.sign(i);0===s&&(s=1),this.treeMove(e,{x:n.x+i+this.spacing*s,y:n.y})}}},{key:"getCellsByLevel",value:function(t){var e,a=this.graph.getCells(),n=[],i=Object(_.a)(a);try{for(i.s();!(e=i.n()).done;){var r=e.value;r.attributes.attrs.level===t&&n.push(r)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"findElementsInside",value:function(t){var e,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.graph.getCells(),n=[],i=Object(_.a)(a);try{for(i.s();!(e=i.n()).done;){var r=e.value,o=r.getBoundingBox();q(t,o)&&n.push(r)}}catch(s){i.e(s)}finally{i.f()}return n}},{key:"findPotentialParents",value:function(t){var e,a=this.graph.getCells(),n=[],i=Object(_.a)(a);try{for(i.s();!(e=i.n()).done;){var r=e.value;q(r.getBoundingBox(),t)&&n.push(r)}}catch(o){i.e(o)}finally{i.f()}return n}},{key:"filterChildren",value:function(t,e){var a,n=this.graph.getCells(),i=[],r=Object(_.a)(n);try{for(r.s();!(a=r.n()).done;){var o=a.value;o.get("parent")===t.id&&i.push(o)}}catch(s){r.e(s)}finally{r.f()}return this.findElementsInside(e,i)}},{key:"treeToFront",value:function(t){for(var e=[t],a=[];e.length>0;){var n,i=Object(_.a)(e);try{for(i.s();!(n=i.n()).done;){var r,o=n.value;o.toFront();var s=o.getEmbeddedCells();(r=a).push.apply(r,Object(w.a)(s))}}catch(c){i.e(c)}finally{i.f()}e=a,a=[]}}},{key:"addSubgraph",value:function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,n=t[Object.keys(t)[0]],i=n.clone(),r=this.subgraphToGraph(n,i,t);return this.treeMove(r,e),a&&"dia.Element.Cut"===a.attributes.type&&a.embed(r),this.handleCollisions(r),i.id}},{key:"subgraphToGraph",value:function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;e.sheet=this,e.addTo(this.graph),null!=n&&n.embed(e);var i=t.get("embeds");if(i){var r,o=Object(_.a)(i);try{for(o.s();!(r=o.n()).done;){var s=r.value,c=this.findCellInSubgraph(s,a);this.subgraphToGraph(c,c.clone(),a,e)}}catch(l){o.e(l)}finally{o.f()}}return e}},{key:"findCellInSubgraph",value:function(t,e){for(var a=0,n=Object.keys(e);a<n.length;a++){var i=e[n[a]];if(i.id===t)return i}return alert("find subgraph failed!"),null}},{key:"treeResize",value:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=t.getParentCell();n;)n.attr("rect/width",n.attributes.attrs.rect.width+e),n.attr("rect/height",n.attributes.attrs.rect.height+e),a&&n.set("position",{x:n.attributes.position.x-e/2,y:n.attributes.position.y-e/2}),n=n.getParentCell()}},{key:"findRoot",value:function(t){for(;t.get("parent");)t=t.getParentCell();return t}},{key:"findLevel",value:function(t){for(var e=0,a=t.getParentCell();a;)e++,a=a.getParentCell();return e}},{key:"colorByLevel",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Q,a=this.findRoot(t);if(a.attr("level",0),"dia.Element.Premise"!==a.attributes.type){a.attr("rect/fill",e.odd);for(var n=0,i=a.getEmbeddedCells();i.length>0;){var r,o=(++n+1)%2,s=[],c=Object(_.a)(i);try{for(c.s();!(r=c.n()).done;){var l=r.value;l.attr("level",n),"dia.Element.Premise"!==l.attributes.type?(l.attributes.attrs.level=n,0===o?l.attr("rect/fill",e.even):l.attr("rect/fill",e.odd),s.push.apply(s,Object(w.a)(l.getEmbeddedCells()))):l.attr("rect/fill",e.premise)}}catch(h){c.e(h)}finally{c.f()}i=s}}else a.attr("rect/fill",e.premise)}},{key:"treeMove",value:function(t,e){for(var a=e.x-t.attributes.position.x,n=e.y-t.attributes.position.y,i=[],r=[t];r.length>0;){i=r,r=[];var o,s=Object(_.a)(i);try{for(s.s();!(o=s.n()).done;){var c,l=o.value;(c=r).push.apply(c,Object(w.a)(l.getEmbeddedCells())),l.position(l.attributes.position.x+a,l.attributes.position.y+n)}}catch(h){s.e(h)}finally{s.f()}}}}]),t}(),$=(a(79),function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).jpaper=null,n.sheet=new Y(Object(m.a)(n)),n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(t,e){this.props.num===this.props.total-1&&(this.sheet.importCells(this.props.cells),this.jpaper.scaleContentToFit())}},{key:"componentDidMount",value:function(){this.jpaper=new v.f.Paper({el:document.getElementById(this.props.id),model:this.sheet.graph,width:200,height:200,preventContextMenu:!1,clickThreshold:1}),this.sheet.importCells(this.props.cells),this.jpaper.scaleContentToFit(),this.jpaper.updateViews(),this.jpaper.setInteractivity(!1),y()("#".concat(this.props.id)).on("mouseover",(function(){y()(this).closest(".history-item").addClass("history-selected")})),y()("#".concat(this.props.id)).on("mouseout",(function(){y()(this).closest(".history-item").removeClass("history-selected")}))}},{key:"refresh",value:function(){}},{key:"render",value:function(){var t={backgroundColor:this.props.active?"#ed6b4d":""};return Object(d.jsx)("div",{className:"history-item",style:t,children:Object(d.jsx)("div",{id:this.props.id,className:"joint-paper history-item-paper",onClick:this.props.onClick})})}}]),a}(u.a.Component)),tt=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).handleJump=function(t){n.setState({index:t}),n.props.handleHistoryJump(n.getItem(t))},n.MAX_SIZE=1024,n.batch_mode=!1,n.batch_state=!1,n.locked=!1,n.state={data:[],index:0},n}return Object(s.a)(a,[{key:"clear",value:function(t){this.setState({data:[],index:0},t&&t)}},{key:"push",value:function(t){if(!this.locked)if(this.batch_mode)this.batch_state=t;else{var e=Object(w.a)(this.state.data);this.state.index!==this.state.data.length-1&&e.splice(this.state.index+1),e.push(t),e.length>=this.MAX_SIZE&&e.shift(),this.setState({data:e,index:e.length-1})}}},{key:"undo",value:function(){var t=this.state.index;return this.state.index>0&&(this.setState({index:this.state.index-1}),t-=1,this.getItem(t))}},{key:"redo",value:function(){var t=this.state.index;return this.state.index<this.state.data.length-1&&(this.setState({index:this.state.index+1}),t+=1,this.getItem(t))}},{key:"getItem",value:function(t){return t<0||t>=this.state.data.length?(console.error("ERROR: Tried to get HistoryItem this.state.data[".concat(t,"], index must be ",0," < ").concat(t," <= ").concat(this.state.data.length)),null):this.state.data[t]}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"startBatch",value:function(){this.batch_mode=!0,this.batch_state=null}},{key:"endBatch",value:function(){this.batch_mode=!1,null!==this.batch_state&&this.push(this.batch_state)}},{key:"render",value:function(){var t=this;return Object(d.jsx)("div",{className:"history",children:this.state.data.map((function(e,a){return 0===a?null:Object(d.jsx)($,{num:a,total:t.state.data.length,id:t.props.id_prefix+a,cells:e,active:t.state.index===a,onClick:t.handleJump.bind(t,a)},a)}))})}}]),a}(u.a.Component),et=(a(80),a(69),function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).handleChangeActive=function(t){n.setState({active:t===n.state.active?-1:t})},n.state={active:-1},n}return Object(s.a)(a,[{key:"render",value:function(){var t=this;return Object(d.jsx)("div",{className:"util-bar-root",children:u.a.Children.map(this.props.children,(function(e,a){return u.a.isValidElement(e)?u.a.cloneElement(e,{active:t.state.active===a,handleChangeActive:t.handleChangeActive.bind(t,a)}):e}))})}}]),a}(u.a.Component)),at=a(63),nt=function(t){return Object(d.jsxs)("div",{className:"util-bar-item-root",children:[Object(d.jsx)(at.a,{icon:t.icon,className:"util-bar-item-icon",onClick:t.handleChangeActive}),Object(d.jsx)("div",{className:"util-bar-active-menu ".concat(!1===t.active?"visually-hidden":""),children:t.children})]})},it=a(33),rt=4e3,ot=4e3,st=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).handleHistoryJump=function(t){n.history.current.lock(),n.sheet.importCells(t),n.history.current.unlock()},n.handleDeleteCell=function(){n.onGraphUpdate()},n.onClick=function(){console.log("clicked",Object(m.a)(n))},n.onKeyUp=function(t){t.keyCode===n.previousPremiseCode&&(n.canInsertPremise=!0)},n.onKeyDown=function(t){if("proof"!==n.getMode()){if("create"===n.getMode()&&j.keys[16]&&n.jpaper.setInteractivity(!1),8===t.keyCode){if(!n.selected_premise)return;var e=new Audio(O);t.shiftKey?(n.props.handlePlayAudio(e),n.selected_premise.obliterate()):"dia.Element.Premise"===n.selected_premise.attributes.type||"dia.Element.Cut"===n.selected_premise.attributes.type?(n.selected_premise.destroy(),n.props.handlePlayAudio(e)):console.error("attempted to delete shape of unknown type: "+n.selected_premise.attributes.type),n.selected_premise=null}var a=t.key.toLocaleUpperCase(),i=a.charCodeAt(0);if(n.canInsertPremise&&1===a.length&&!t.ctrlKey&&!t.metaKey&&i>=65&&i<=90){var r={attrs:{text:{text:a}},position:n.getRelativeMousePos()};n.sheet.addPremise(r),n.canInsertPremise=!1,n.previousPremiseCode=i}if(13===t.keyCode){var o={position:n.getRelativeMousePos()};n.selected_premise?(o.child=n.selected_premise,n.sheet.addCut(o)):n.sheet.addCut(o)}if(49===t.keyCode&&n.selected_premise&&(n.saved_template=n.sheet.graph.cloneSubgraph([n.selected_premise],{deep:!0})),50===t.keyCode){var s=n.getRelativeMousePos();n.saved_template&&n.sheet.addSubgraph(n.saved_template,s,n.selected_premise)}}},n.onMouseDown=function(t){if(j.keys[16]&&"create"===n.getMode()){n.initial_cut_pos=Object.assign({},j.mousePosition),n.initial_cut_pos.x-=n.paper_element.getBoundingClientRect().left,n.initial_cut_pos.y-=n.paper_element.getBoundingClientRect().top;var e={position:Object.assign({},n.initial_cut_pos),size:{width:0,height:0}};n.history.current.lock(),n.temp_cut=n.sheet.addCut(e),n.temp_cut.active(),t.preventDefault()}},n.onMouseUp=function(){if("proof"===n.getMode()){if(n.history.current.startBatch(),!n.selected_premise&&n.props.action&&"insertDoubleCut"===n.props.action.name){var t=n.getRelativeMousePos();n.props.action(n.sheet,null,t),n.props.handleClearAction()}if(!n.selected_premise&&n.props.action&&"bound iterationend"===n.props.action.name){var e=n.getRelativeMousePos();n.props.action(n.sheet,null,e),n.props.handleClearAction()}n.history.current.endBatch()}if(n.temp_cut&&"create"===n.getMode()){var a=k.a.clone(n.temp_cut.get("position")),i=k.a.clone({width:n.temp_cut.attr("rect/width"),height:n.temp_cut.attr("rect/height")}),r={position:a,attrs:{rect:Object(g.a)({},i)}};n.temp_cut.remove(),n.history.current.unlock(),n.sheet.addCut(r)}n.jpaper.setInteractivity(!0),n.temp_cut=null},n.onMouseMove=function(){if("create"===n.getMode()&&j.isMouseDown&&j.keys[16]&&n.temp_cut){var t=n.getRelativeMousePos();n.temp_cut.set("position",{x:Math.min(t.x,n.initial_cut_pos.x),y:Math.min(t.y,n.initial_cut_pos.y)}),n.temp_cut.attr("rect/width",Math.abs(t.x-n.initial_cut_pos.x)),n.temp_cut.attr("rect/height",Math.abs(t.y-n.initial_cut_pos.y))}},n.onMouseEnter=function(){n.paper_element.focus()},n.sheet=new Y(Object(m.a)(n)),n.jpaper=null,n.paper_element=null,n.paperRoot=u.a.createRef(),n.selected_premise=null,n.saved_template=null,n.temp_cut=null,n.initial_cut_pos={x:0,y:0},n.canInsertPremise=!0,n.previousPremiseCode=0,n.state={show:!0},n.UtilBar=u.a.createRef(),n.history=u.a.createRef(),n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.jpaper=new v.f.Paper({el:document.getElementById(this.props.id),model:this.sheet.graph,width:rt,height:ot,preventContextMenu:!1,clickThreshold:1}),this.paper_element=document.getElementById(this.props.id),this.setPaperEvents(),this.history.current.push(this.sheet.exportAsJSON())}},{key:"onGraphUpdate",value:function(){var t=this.sheet.graph.getCells();this.history.current.push(t)}},{key:"show",value:function(){y()(this.paperRoot.current).css("display","flex")}},{key:"hide",value:function(){y()(this.paperRoot.current).css("display","none")}},{key:"export",value:function(){for(var t=this.sheet.graph.toJSON(),e=0;e<t.cells.length;e++)delete t.cells[e].sheet;var a=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),n=document.createElement("a"),i=URL.createObjectURL(a);n.href=i,n.download="graph.json",document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n),window.URL.revokeObjectURL(i)}),0)}},{key:"import",value:function(){var t=this,e=document.createElement("input");e.type="file",e.onchange=function(e){var a=e.target.files[0];if("application/json"===a.type){var n=new FileReader;n.readAsText(a,"UTF-8"),n.onload=function(e){var a=e.target.result;if(window.confirm("Erase your current workspace and import graph?")){t.sheet.graph.clear();var n=JSON.parse(a);t.parseJSON(n.cells)}}}else alert("File must be of .JSON type")},e.click()}},{key:"parseJSON",value:function(t){for(var e={};t.length>0;){var a=t.shift(),n=a.type;!a.parent||e.hasOwnProperty(a.parent)?"dia.Element.Cut"===n?(this.sheet.addCut(a),e[a.id]=!0):"dia.Element.Premise"===n&&(this.sheet.addPremise(a),e[a.id]=!0):t.push(a)}}},{key:"getMode",value:function(){return this.props.mode||"create"}},{key:"setupModalPaper",value:function(){this.sheet.graph.clear()}},{key:"copyFrom",value:function(t){for(var e=t.sheet.graph.getCells(),a=0;a<e.length;a++)e[a]=e[a].clone(),e[a].graph=this.sheet.graph;this.sheet.graph.addCells(e)}},{key:"setPaperEvents",value:function(){var t=this;this.jpaper.on("element:mouseenter",(function(e,a){var n=e.model;n.findView(t.jpaper).showTools(),n.attr("rect/stroke","red"),n.attr("text/fill","red"),t.selected_premise=n})),this.jpaper.on("element:mouseleave",(function(e,a){var n=e.model,i=n.findView(t.jpaper);i&&(i.hideTools(),n.attr("rect/stroke","black"),n.attr("text/fill","black"),t.selected_premise=void 0)})),this.jpaper.on("cell:pointerdown",(function(e,a,n,i){console.log(e);var r=e.model;console.log("cell",r),r.get("embeds")&&0!==r.get("embeds").length||r.toFront(),r.get("parent")&&t.sheet.graph.getCell(r.get("parent")).unembed(r),r.active(),t.sheet.treeToFront(t.sheet.findRoot(r))})),this.jpaper.on("cell:pointerup",(function(e,a,n,i){var r,o=e.model;t.sheet.handleCollisions(o),o.inactive(),t.props.action||t.onGraphUpdate(),t.props.action&&(r=t.props.action(t.sheet,o,t.getRelativeMousePos())),t.props.handleClearAction&&!r&&t.props.handleClearAction(),r&&t.props.handleActionChange(r),t.selected_premise=null})),y()(this.paperRoot.current).on("keydown",(function(e){if(90===e.keyCode&&(e.ctrlKey||e.metaKey)&&!e.shiftKey){var a=t.history.current.undo();t.selected_premise=null,a&&(t.history.current.lock(),t.sheet.importCells(a),t.history.current.unlock())}if(90===e.keyCode&&(e.ctrlKey||e.metaKey)&&e.shiftKey){var n=t.history.current.redo();n&&(t.history.current.lock(),t.sheet.importCells(n),t.history.current.unlock())}}))}},{key:"getRelativeMousePos",value:function(){return{x:j.mousePosition.x-this.paper_element.getBoundingClientRect().left,y:j.mousePosition.y-this.paper_element.getBoundingClientRect().top}}},{key:"render",value:function(){var t=this;if(!this.state.show)return null;var e={width:this.props.wrapperWidth||"100%",height:this.props.wrapperHeight||"100%"};return Object(d.jsxs)("div",{className:"paper-root",ref:this.paperRoot,children:[Object(d.jsx)("div",{className:"paper-wrapper",style:e,children:Object(d.jsx)("div",{id:this.props.id,className:"joint-paper",onClick:this.onClick,onKeyDown:function(e){return t.onKeyDown(e)},onKeyUp:function(e){return t.onKeyUp(e)},onMouseDown:function(e){return t.onMouseDown(e)},onMouseUp:this.onMouseUp,onMouseMove:this.onMouseMove,onMouseEnter:this.onMouseEnter,tabIndex:"0"})}),Object(d.jsx)(et,{ref:this.UtilBar,children:Object(d.jsx)(nt,{icon:it.e,children:Object(d.jsx)(tt,{ref:this.history,id_prefix:"".concat(this.props.id,"-"),handleHistoryJump:this.handleHistoryJump,handleInitializeHistory:this.handleInitializeHistory})})})]})}}]),a}(u.a.Component);a(86);var ct=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(){return Object(o.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return Object(d.jsxs)("button",{className:"button "+(this.props.active?"button-active":""),onClick:this.props.onClick,children:[Object(d.jsx)("div",{className:"tooltip-text",children:this.props.tooltip_text}),Object(d.jsx)(at.a,{icon:this.props.icon,className:"button-icon"}),Object(d.jsx)("p",{children:this.props.text})]})}}]),a}(u.a.Component);ct.defaultProps={text:"Button",onClick:console.log("Button Clicked! Please define a on click function."),icon:it.b,tooltip_text:"Tooltip!"};a(87);var lt=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(){return Object(o.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var t=this;return Object(d.jsx)("div",{className:"button-group",children:this.props.buttons.map((function(e){return Object(d.jsx)(ct,{active:t.props.action===e.action,text:e.text,onClick:e.onClick,icon:e.icon,tooltip_text:e.tooltip_text},e.text)}))})}}]),a}(u.a.Component),ht=(a(88),function(t,e,a){if(console.log("ARGS",arguments),"Cut"!==e.__proto__.constructor.name||e.attributes.level%2!==0){console.log("opening modal...");var n=t.paper;n.props.handleOpenModal(a)}}),ut=function(t,e){if(console.log(e.attributes.attrs.level),e.attributes.attrs.level%2===0){var a=e.getEmbeddedCells({deep:!0}),n=t.graph.getCell(e.attributes.parent);e.destroy();for(var i=0;i<a.length;i++)a[i].destroy();n&&t.handleCollisions(n)}},dt=function(t,e){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n={},i={};if(!e&&a)n=a,i={width:80,height:80};else{if(!e)throw new Error("Bad arguments");n=e.get("position"),i={width:e.attr("rect/width"),height:e.attr("rect/height")}}for(var r=[.8,.25],o=[],s=0;s<r.length;s++)o.push(t.addCut({position:{x:n.x-i.width*r[s]/2,y:n.y-i.height*r[s]/2},attrs:{rect:{width:i.width*(1+r[s]),height:i.height*(1+r[s])}}},!1));o[0].embed(o[1]),t.colorByLevel(o[0]);var c=t.paper.selected_premise;c&&"dia.Element.Cut"===c.attributes.type&&(c.embed(o[0]),t.colorByLevel(c),t.pack(c)),t.handleCollisions(o[0])},pt=function(t,e){var a;console.log("MODEL: ",e);var n=t.graph;if("Cut"===e.__proto__.constructor.name&&1===(null===(a=e.attributes.embeds)||void 0===a?void 0:a.length)&&"Cut"===n.getCell(e.attributes.embeds[0]).__proto__.constructor.name){var i=n.getCell(e.attributes.embeds[0]).attributes.embeds;n.getCell(e.attributes.embeds[0]).destroy(),e.destroy(),e.attributes.parent?t.handleCollisions(n.getCell(e.attributes.parent)):null===i||void 0===i||i.forEach((function(e){"Cut"===n.getCell(e).__proto__.constructor.name&&t.handleCollisions(n.getCell(e))}))}},ft=function(t,e){return gt.bind(null,e)},gt=function(t,e,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=e.graph.cloneSubgraph([t],{deep:!0}),r=e.addSubgraph(i,n,a);i=e.graph.getCell(r),yt(e,t,i)||bt(e,i)},mt=function(t,e){for(var a=e.id,n=e;n.attributes.parent;){if("Cut"!==(n=t.graph.getCell(n.attributes.parent)).__proto__.constructor.name)return void console.error("Parent is of type "+n.__proto__.constructor.name+". Expected Cut. Contact administrator.");var i=n.attributes.embeds;null===i||void 0===i||i.forEach((function(n){var i=t.graph.getCell(n);i.id!==a&&vt(t,e,i)&&bt(t,e)}))}var r=t.graph.attributes.cells.models;null===r||void 0===r||r.forEach((function(n){var i=t.graph.getCell(n);0===(null===i||void 0===i?void 0:i.attributes.attrs.level)&&(null===i||void 0===i?void 0:i.id)!==a&&vt(t,e,i)&&bt(t,e)}))};function vt(t,e,a){if(e.__proto__.constructor.name!==a.__proto__.constructor.name)return!1;if("Premise"===e.__proto__.constructor.name)return e.attributes.attrs.text.text===a.attributes.attrs.text.text;if("Cut"===e.__proto__.constructor.name){var n=Object(w.a)(e.attributes.embeds||[]),i=Object(w.a)(a.attributes.embeds||[]);if(!n&&!i)return!0;if(n.length!==i.length)return!1;t:for(;n.length>0;){for(var r=t.graph.getCell(n[0]),o=0;o<i.length;o++)if(vt(t,r,t.graph.getCell(i[o]))){n.shift(),i.splice(o,1);continue t}return!1}return!0}return console.error("Can not compare models of type "+e.__proto__.constructor.name+". Contact administrator"),!1}function bt(t,e){var a;if("Premise"===e.__proto__.constructor.name||0===(null===(a=e.attributes.embeds)||void 0===a?void 0:a.length))return e.destroy(),void console.log("ballse");e.attributes.embeds.forEach((function(e){bt(t,t.graph.getCell(e))})),e.destroy()}function yt(t,e,a){if(!vt(t,e,a))return console.error("Model discrepency when detecting legality of iteration."),!1;if(0===e.attributes.attrs.level)return!0;if(e.attributes.attrs.level>a.attributes.attrs.level)return!1;var n=Object(w.a)(t.graph.getCell(e.attributes.parent).attributes.embeds);for(n.splice(n.indexOf(e.id,1));n.length>0;){var i,r=n.shift();if(r===a.id)return!0;if("Cut"===t.graph.getCell(r).__proto__.constructor.name)null===(i=t.graph.getCell(r).attributes.embeds)||void 0===i||i.forEach((function(t){n.push(t)}))}return!1}var xt=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).state={buttons:{create:[{text:"Add Premise",action:mt,onClick:function(){console.log("Adding premise...")},icon:it.h,tooltip_text:"Add a premise by hovering over the sheet and pressing a letter on your keyboard."},{text:"Cut",action:mt,onClick:function(){console.log("Cutting...")},icon:it.j,tooltip_text:"Add a cut by clicking and dragging on the sheet of assertion."}],proof:[{text:"Insertion",action:ht,onClick:function(){n.props.handleActionChange(ht),console.log("Loading insertion into action...")},icon:it.h,tooltip_text:"Insert a graph by clicking on any odd level."},{text:"Erasure",action:ut,onClick:function(){n.props.handleActionChange(ut),console.log("Performing erasure...")},icon:it.f,tooltip_text:"Remove a graph by clicking on anything on an even level."},{text:"Insert Double Cut",action:dt,onClick:function(){n.props.handleActionChange(dt),console.log("Inserting double cut...")},icon:it.i,tooltip_text:"Add a double cut by clicking on the subgraph you want to encapsulate."},{text:"Delete Double Cut",action:pt,onClick:function(){n.props.handleActionChange(pt),console.log("Deleting double cut...")},icon:it.g,tooltip_text:"Remove a double cut by clicking on the outer-most cut of the double cut."},{text:"Iteration",action:ft,onClick:function(){n.props.handleActionChange(ft),console.log("Performing iteration...")},icon:it.a,tooltip_text:"Clone any premise an even number of layers layers deeper by first clicking on the premise and then the desired location."},{text:"Deiteration",action:mt,onClick:function(){n.props.handleActionChange(mt),console.log("Performing deiteration...")},icon:it.c,tooltip_text:"Remove any premise an even number of layers deeper by clicking on the premise you wish to remove."}]},color:{text:{create:"#E0FBFC",proof:"#293241"},background:{create:"#3D5A80",proof:"#98C1D9"}}},n}return Object(s.a)(a,[{key:"render",value:function(){return Object(d.jsx)("div",{className:"menu-bar",style:{backgroundColor:this.state.color.background[this.props.mode],color:this.state.color.text[this.props.mode]},children:Object(d.jsxs)("div",{id:"side-wrapper",children:[Object(d.jsxs)("div",{id:"mode-header",children:[Object(d.jsxs)("h2",{children:[this.props.mode.charAt(0).toUpperCase()+this.props.mode.slice(1)," Mode"]}),Object(d.jsx)(ct,{text:"Switch Mode",onClick:this.props.onStateSwitch,icon:it.d,tooltip_text:"Toggles to "+("proof"===this.props.mode?"create":"proof")+" mode"})]}),Object(d.jsx)(lt,{buttons:this.state.buttons[this.props.mode],mode:this.props.mode,action:this.props.action})]})})}}]),a}(u.a.Component),jt=(a(89),function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(){return Object(o.a)(this,a),e.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return this.props.show?(console.log("rendering..."),Object(d.jsx)("div",{class:"modal-bg",children:Object(d.jsxs)("div",{class:"modal-body",children:[Object(d.jsx)("div",{class:"modal-top-bar",children:this.props.buttons.map((function(t){return Object(d.jsx)("button",{class:"modal-item modal-item-".concat(t.name),onClick:t.onClick,children:t.text},t.name)}))}),Object(d.jsx)("div",{class:"modal-content",children:this.props.children})]})})):null}}]),a}(u.a.Component));a(90);new Event("load-modal");var Ct=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).handleActionChange=function(t){n.setState({action:t})},n.handleModalExit=function(){n.setState({showModal:!1})},n.handleOpenModal=function(t){n.setState({showModal:!0}),n.insertPosition=Object.assign({},t)},n.handleModalInsert=function(t){console.log("inserting...",t),n.proofPaper.current.sheet.importFromJSON(n.modalPaper.current.sheet.exportAsJSON()),n.handleModalExit()},n.state={mode:"create",action:null,showModal:!1},n.insertPosition={x:0,y:0},n.modalPaper=u.a.createRef(),n.mainPaper=u.a.createRef(),n.proofPaper=u.a.createRef(),n.history=[],n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.proofPaper.current.hide(),this.proofPaper.current.history.current.clear()}},{key:"componentDidUpdate",value:function(t,e){if(e.mode!==this.state.mode)if("proof"===this.state.mode){this.mainPaper.current.hide(),this.proofPaper.current.sheet.graph.clear();var a=this.mainPaper.current.sheet.exportAsJSON();this.proofPaper.current.sheet.importFromJSON(a),this.proofPaper.current.show()}else this.mainPaper.current.show(),this.proofPaper.current.hide(),this.proofPaper.current.history.current.clear()}},{key:"handleStateSwitch",value:function(){this.setState({mode:"create"===this.state.mode?"proof":"create"})}},{key:"handleClearAction",value:function(){this.handleActionChange(null)}},{key:"render",value:function(){var t=[{name:"insert",text:"Insert",onClick:this.handleModalInsert},{name:"cancel",text:"X",onClick:this.handleModalExit}];return Object(d.jsxs)("div",{className:"workspace",children:[Object(d.jsx)(xt,{mode:this.state.mode,onStateSwitch:this.handleStateSwitch.bind(this),handleActionChange:this.handleActionChange.bind(this),action:this.state.action}),Object(d.jsx)(st,{id:this.props.paper_id,mode:this.state.mode,action:this.state.action,handleClearAction:this.handleClearAction.bind(this),handleActionChange:this.handleActionChange,handleOpenModal:this.handleOpenModal,handlePlayAudio:this.props.handlePlayAudio,ref:this.mainPaper}),Object(d.jsx)(st,{id:this.props.paper_id+"-proof-paper",mode:this.state.mode,action:this.state.action,handleClearAction:this.handleClearAction.bind(this),handleActionChange:this.handleActionChange,handleOpenModal:this.handleOpenModal,handlePlayAudio:this.props.handlePlayAudio,ref:this.proofPaper}),Object(d.jsx)(jt,{show:this.state.showModal,buttons:t,children:Object(d.jsx)(st,{id:this.props.paper_id+"-modal-paper",mode:"create",action:null,handleClearAction:null,handleActionChange:null,handleOpenModal:null,handlePlayAudio:this.props.handlePlayAudio,wrapperWidth:"100%",wrapperHeight:"72vh",ref:this.modalPaper})})]})}}]),a}(u.a.Component),kt=function(t){Object(c.a)(a,t);var e=Object(l.a)(a);function a(t){var n;return Object(o.a)(this,a),(n=e.call(this,t)).handleMuteToggle=function(){n.setState({muted:!n.state.muted});var t,e=(t="Toggle Sound",y()(".header-bar").find('[aria-label="'.concat(t,'"]'))),a=e.find(".menu-item-label");e.toggleClass("mute-active"),e.hasClass("mute-active")?a.html("Unmute"):a.html("Mute")},n.handlePlayAudio=function(t){n.state.muted||(n.sound=t,n.sound.play())},n.getGraphForExport=function(){return n.workspace.current.mainPaper.current.sheet.graph},n.exportMainGraph=function(){n.workspace.current.mainPaper.current.export()},n.importMainGraph=function(){n.workspace.current.mainPaper.current.import()},n.setGraphDataOnImport=function(t){var e=n.workspace.current.mainPaper.current.sheet.graph;e.clear();for(var a=JSON.parse(t),i=0;i<a.cells.length;i++)"dia.Element.Cut"===a.cells[i].type&&(a.cells[i].sheet=n.workspace.current.mainPaper.current.sheet);e.fromJSON(a)},n.workspace=u.a.createRef(),n.sound=null,n.state={muted:!0},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){console.log("WORKSPACE",this.workspace)}},{key:"componentDidUpdate",value:function(t,e){this.state.muted&&this.sound&&(this.sound.pause(),this.sound.currentTime=0)}},{key:"render",value:function(){return Object(d.jsxs)("div",{id:"app",className:"app",children:[Object(d.jsx)(f,{id:"header",muted:this.state.muted,handleMuteToggle:this.handleMuteToggle,exportMainGraph:this.exportMainGraph,importMainGraph:this.importMainGraph,getGraphForExport:this.getGraphForExport,setGraphDataOnImport:this.setGraphDataOnImport}),Object(d.jsx)(Ct,{paper_id:"main-paper",ref:this.workspace,handlePlayAudio:this.handlePlayAudio})]})}}]),a}(u.a.Component);console.log("Starting..."),window.joint=r;var Ot=i.a.render(Object(d.jsx)(kt,{}),document.getElementById("root"));console.log(Ot),console.log(Ot.workspace)}},[[92,1,2]]]);
//# sourceMappingURL=main.e491afaa.chunk.js.map